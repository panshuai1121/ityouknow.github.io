I"€<p>by æ¥µå…‰</p>

<p>ä¸Šæ¬¡ç»™å¤§å®¶ä»‹ç»äº† Python å¦‚ä½•æ“ä½œ Excel ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰è¿˜æŒºæœ‰è¶£çš„ï¼Œä»Šå¤©ä¸ºå¤§å®¶å†ä»‹ç»ä¸‹ï¼Œç”¨ Python å¦‚ä½•æ“ä½œ Word ï¼Œè¿™ä¸ªå¯èƒ½è·Ÿæ•°æ®å¤„ç†å…³ç³»ä¸å¤§ï¼Œç”¨çš„ä¹Ÿä¸å¤šï¼Œä¸è¿‡å¯ä»¥å…ˆäº†è§£ä¸‹éƒ½èƒ½å®ç°ä»€ä¹ˆåŠŸèƒ½ï¼Œä»¥å¤‡ä¸æ—¶ä¹‹éœ€ã€‚</p>

<!--more-->

<h2 id="å®‰è£…-python-docx">å®‰è£… python-docx</h2>

<p>å¤„ç† Word éœ€è¦ç”¨åˆ° python-docx åº“ï¼Œç›®å‰ç‰ˆæœ¬ä¸º <code class="highlighter-rouge">0.8.10</code> ï¼Œæ‰§è¡Œå¦‚ä¸‹å®‰è£…å‘½ä»¤ï¼š</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pip3 <span class="nb">install </span>python-docx
<span class="c">################# è¿è¡Œç»“æœ ################</span>
Collecting python-docx
  Downloading https://files.pythonhosted.org/packages/e4/83/c66a1934ed5ed8ab1dbb9931f1779079f8bca0f6bbc5793c06c4b5e7d671/python-docx-0.8.10.tar.gz <span class="o">(</span>5.5MB<span class="o">)</span>
     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5.5MB 553kB/s
Requirement already satisfied: lxml&gt;<span class="o">=</span>2.3.2 <span class="k">in</span> /usr/local/lib/python3.7/site-packages <span class="o">(</span>from python-docx<span class="o">)</span> <span class="o">(</span>4.4.1<span class="o">)</span>
Building wheels <span class="k">for </span>collected packages: python-docx
  Building wheel <span class="k">for </span>python-docx <span class="o">(</span>setup.py<span class="o">)</span> ... <span class="k">done
  </span>Stored <span class="k">in </span>directory: /Users/mjg/Library/Caches/pip/wheels/18/0b/a0/1dd62ff812c857c9e487f27d80d53d2b40531bec1acecfa47b
Successfully built python-docx
Installing collected packages: python-docx
Successfully installed python-docx-0.8.10
</code></pre></div></div>

<p>OKï¼Œå¦‚æœæç¤ºä»¥ä¸Šä¿¡æ¯åˆ™å®‰è£…æˆåŠŸã€‚</p>

<h2 id="å†™å…¥-word">å†™å…¥ Word</h2>

<p>å¹³æ—¶æˆ‘ä»¬åœ¨æ“ä½œ Word å†™æ–‡æ¡£çš„æ—¶å€™ï¼Œä¸€èˆ¬åˆ†ä¸ºå‡ éƒ¨åˆ†ï¼šæ ‡é¢˜ã€ç« èŠ‚ã€æ®µè½ã€å›¾ç‰‡ã€è¡¨æ ¼ã€å¼•ç”¨ä»¥åŠé¡¹ç›®ç¬¦å·ç¼–å·ç­‰ã€‚ä¸‹é¢æˆ‘ä»¬å°±æŒ‰è¿™å‡ éƒ¨åˆ†å¦‚ä½•ç”¨ Python æ“ä½œæ¥ä¸€ä¸€ä»‹ç»ã€‚</p>

<h3 id="æ ‡é¢˜">æ ‡é¢˜</h3>

<p>æ–‡æ¡£æ ‡é¢˜åˆ›å»ºæ¯”è¾ƒç®€å•ï¼Œé€šè¿‡ <code class="highlighter-rouge">Document()</code> åˆ›å»ºå‡ºä¸€ä¸ªç©ºç™½æ–‡æ¡£ï¼Œåªè¦è°ƒç”¨ <code class="highlighter-rouge">add_heading</code> æ–¹æ³•å°±èƒ½åˆ›å»ºæ ‡é¢˜ã€‚</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># word_1.py
</span>
<span class="c1"># å¯¼å…¥åº“
</span><span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Pt</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Inches</span>
<span class="kn">from</span> <span class="nn">docx.oxml.ns</span> <span class="kn">import</span> <span class="n">qn</span>

<span class="c1"># æ–°å»ºç©ºç™½æ–‡æ¡£
</span><span class="n">doc1</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>

<span class="c1"># æ–°å¢æ–‡æ¡£æ ‡é¢˜
</span><span class="n">doc1</span><span class="p">.</span><span class="n">add_heading</span><span class="p">(</span><span class="s">'å¦‚ä½•ä½¿ç”¨ Python åˆ›å»º Word'</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># ä¿å­˜æ–‡ä»¶
</span><span class="n">doc1</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'word1.docx'</span><span class="p">)</span>
</code></pre></div></div>

<p>è¿™æ ·å°±å®Œæˆäº†åˆ›å»ºæ–‡æ¡£å’Œæ–‡ç« æ ‡é¢˜çš„æ“ä½œï¼Œä¸‹é¢é€šè¿‡å‘½ä»¤ <code class="highlighter-rouge">python word_1.py </code> è¿è¡Œç¨‹åºï¼Œä¼šç”Ÿæˆåä¸º <code class="highlighter-rouge">word1.docx</code> çš„æ–‡æ¡£ï¼Œæ‰“å¼€æ–‡ç« æ˜¾ç¤ºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>

<p><img src="http://www.justdopython.com/assets/images/2019/python/python_word_01.png" alt="æ ‡é¢˜" /></p>

<h3 id="ç« èŠ‚ä¸æ®µè½">ç« èŠ‚ä¸æ®µè½</h3>

<p>æœ‰äº†æ–‡ç« æ ‡é¢˜ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ç« èŠ‚å’Œæ®µè½æ˜¯æ€ä¹ˆæ“ä½œçš„ï¼Œåœ¨ä¸Šé¢ä»£ç åé¢å¢åŠ ç« èŠ‚å’Œæ®µè½æ“ä½œçš„ä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># word_1.py
</span>
<span class="c1"># å¯¼å…¥åº“
</span><span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Pt</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Inches</span>
<span class="kn">from</span> <span class="nn">docx.oxml.ns</span> <span class="kn">import</span> <span class="n">qn</span>

<span class="c1"># æ–°å»ºç©ºç™½æ–‡æ¡£
</span><span class="n">doc1</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>

<span class="c1"># æ–°å¢æ–‡æ¡£æ ‡é¢˜
</span><span class="n">doc1</span><span class="p">.</span><span class="n">add_heading</span><span class="p">(</span><span class="s">'å¦‚ä½•ä½¿ç”¨ Python åˆ›å»º Word'</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># åˆ›å»ºæ®µè½æè¿°
</span><span class="n">doc1</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨ Word ç”¨æ¥åšæ–‡ç« çš„å¤„ç†ï¼Œå¯èƒ½æ²¡æƒ³è¿‡å®ƒå¯ä»¥ç”¨ Python ç”Ÿæˆï¼Œä¸‹é¢æˆ‘ä»¬å°±ä»‹ç»å…·ä½“å¦‚ä½•æ“ä½œâ€¦â€¦'</span><span class="p">)</span>

<span class="c1"># åˆ›å»ºä¸€çº§æ ‡é¢˜
</span><span class="n">doc1</span><span class="p">.</span><span class="n">add_heading</span><span class="p">(</span><span class="s">'å®‰è£… python-docx åº“'</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># åˆ›å»ºæ®µè½æè¿°
</span><span class="n">doc1</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'ç°åœ¨å¼€å§‹æˆ‘ä»¬æ¥ä»‹ç»å¦‚ä½•å®‰è£… python-docx åº“ï¼Œå…·ä½“éœ€è¦ä»¥ä¸‹ä¸¤æ­¥æ“ä½œï¼š'</span><span class="p">)</span>

<span class="c1"># åˆ›å»ºäºŒçº§æ ‡é¢˜
</span><span class="n">doc1</span><span class="p">.</span><span class="n">add_heading</span><span class="p">(</span><span class="s">'ç¬¬ä¸€æ­¥ï¼šå®‰è£… Python'</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># ä¿å­˜æ–‡ä»¶
</span><span class="n">doc1</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'word1.docx'</span><span class="p">)</span>
</code></pre></div></div>

<p>ä¸Šé¢æˆ‘ä»¬è¯´äº† <code class="highlighter-rouge">add_heading</code> æ–¹æ³•ç”¨æ¥å¢åŠ æ–‡ç« æ ‡é¢˜ï¼Œä¸è¿‡é€šè¿‡ä¸Šé¢ä»£ç æˆ‘ä»¬èƒ½çŸ¥é“ï¼Œè¿™ä¸ªæ–¹æ³•çš„ç¬¬äºŒä¸Šå‚æ•°ä¸ºæ•°å­—ï¼Œå…¶å®è¿™ä¸ªå°±æ˜¯ç”¨æ¥æ ‡ç¤ºå‡ çº§æ ‡é¢˜çš„ï¼Œåœ¨æˆ‘ä»¬å¹³æ—¶å°±ç”¨æ¥æ ‡ç¤ºç« èŠ‚ã€‚<code class="highlighter-rouge">add_paragraph</code> æ–¹æ³•åˆ™æ˜¯ç”¨æ¥åœ¨æ–‡ç« ä¸­å¢åŠ æ®µè½çš„ï¼Œé‚£æˆ‘ä»¬ç°åœ¨å°±é€šè¿‡å‘½ä»¤ <code class="highlighter-rouge">python word_1.py </code> è¿è¡Œç¨‹åºçœ‹ä¸‹æ•ˆæœï¼š</p>

<p><img src="http://www.justdopython.com/assets/images/2019/python/python_word_02.png" alt="ç« èŠ‚æ®µè½" /></p>

<h3 id="å­—ä½“å’Œå¼•ç”¨">å­—ä½“å’Œå¼•ç”¨</h3>

<p>å‰é¢æˆ‘ä»¬é€šè¿‡ <code class="highlighter-rouge">add_paragraph</code> æ–¹æ³•å¢åŠ äº†ä¸¤ä¸ªæ®µè½ï¼Œç°åœ¨æˆ‘ä»¬å°±çœ‹ä¸‹å¦‚ä½•å¯¹æ®µè½ä¸­å­—ä½“å¦‚ä½•æ“ä½œï¼Œä»¥åŠå¼•ç”¨æ®µè½çš„æ“ä½œã€‚ç»§ç»­ä¿®æ”¹ä»¥ä¸Šä»£ç ï¼Œå¢åŠ å¯¹æ–‡ç« å­—ä½“å­—å·ã€åŠ ç²—ã€å€¾æ–œç­‰æ“ä½œï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># word_1.py
</span>
<span class="c1"># å¯¼å…¥åº“
</span><span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Pt</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Inches</span>
<span class="kn">from</span> <span class="nn">docx.oxml.ns</span> <span class="kn">import</span> <span class="n">qn</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">RGBColor</span>

<span class="c1"># æ–°å»ºç©ºç™½æ–‡æ¡£
</span><span class="n">doc1</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>

<span class="c1"># æ–°å¢æ–‡æ¡£æ ‡é¢˜
</span><span class="n">doc1</span><span class="p">.</span><span class="n">add_heading</span><span class="p">(</span><span class="s">'å¦‚ä½•ä½¿ç”¨ Python åˆ›å»º Word'</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># åˆ›å»ºæ®µè½æè¿°
</span><span class="n">doc1</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨ Word ç”¨æ¥åšæ–‡ç« çš„å¤„ç†ï¼Œå¯èƒ½æ²¡æƒ³è¿‡å®ƒå¯ä»¥ç”¨ Python ç”Ÿæˆï¼Œä¸‹é¢æˆ‘ä»¬å°±ä»‹ç»å…·ä½“å¦‚ä½•æ“ä½œâ€¦â€¦'</span><span class="p">)</span>

<span class="c1"># åˆ›å»ºä¸€çº§æ ‡é¢˜
</span><span class="n">doc1</span><span class="p">.</span><span class="n">add_heading</span><span class="p">(</span><span class="s">'å®‰è£… python-docx åº“'</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># åˆ›å»ºæ®µè½æè¿°
</span><span class="n">doc1</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'ç°åœ¨å¼€å§‹æˆ‘ä»¬æ¥ä»‹ç»å¦‚ä½•å®‰è£… python-docx åº“ï¼Œå…·ä½“éœ€è¦ä»¥ä¸‹ä¸¤æ­¥æ“ä½œï¼š'</span><span class="p">)</span>

<span class="c1"># åˆ›å»ºäºŒçº§æ ‡é¢˜
</span><span class="n">doc1</span><span class="p">.</span><span class="n">add_heading</span><span class="p">(</span><span class="s">'ç¬¬ä¸€æ­¥ï¼šå®‰è£… Python'</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># åˆ›å»ºæ®µè½ï¼Œæ·»åŠ æ–‡æ¡£å†…å®¹
</span><span class="n">paragraph</span> <span class="o">=</span> <span class="n">doc1</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'è¿™æ˜¯ç¬¬ä¸€æ­¥çš„å®‰è£…æè¿°ï¼'</span><span class="p">)</span>

<span class="c1"># æ®µè½ä¸­å¢åŠ æ–‡å­—ï¼Œå¹¶è®¾ç½®å­—ä½“å­—å·
</span><span class="n">run</span> <span class="o">=</span> <span class="n">paragraph</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="s">'(æ³¨æ„ï¼šè¿™é‡Œè®¾ç½®äº†å­—å·ä¸º20)'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># è®¾ç½®è‹±æ–‡å­—ä½“
</span><span class="n">run</span> <span class="o">=</span> <span class="n">doc1</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'è¿™é‡Œè®¾ç½®è‹±æ–‡å­—ä½“ï¼š'</span><span class="p">).</span><span class="n">add_run</span><span class="p">(</span><span class="s">'This Font is Times New Roman '</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'Times New Roman'</span>

<span class="c1"># è®¾ç½®ä¸­æ–‡å­—ä½“
</span><span class="n">run</span> <span class="o">=</span> <span class="n">doc1</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'è¿™é‡Œè®¾ç½®ä¸­æ–‡å­—ä½“ï¼š'</span><span class="p">).</span><span class="n">add_run</span><span class="p">(</span><span class="s">'å½“å‰å­—ä½“ä¸ºé»‘ä½“'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">name</span><span class="o">=</span><span class="s">'é»‘ä½“'</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">run</span><span class="p">.</span><span class="n">_element</span>
<span class="n">r</span><span class="p">.</span><span class="n">rPr</span><span class="p">.</span><span class="n">rFonts</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">qn</span><span class="p">(</span><span class="s">'w:eastAsia'</span><span class="p">),</span> <span class="s">'é»‘ä½“'</span><span class="p">)</span>

<span class="c1"># è®¾ç½®æ–œä½“
</span><span class="n">run</span> <span class="o">=</span> <span class="n">doc1</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'è¿™æ®µè®¾ç½®ï¼š'</span><span class="p">).</span><span class="n">add_run</span><span class="p">(</span><span class="s">'æ–‡å­—çš„æ˜¯æ–œä½“ '</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">italic</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1"># è®¾ç½®ç²—ä½“
</span><span class="n">run</span> <span class="o">=</span> <span class="n">doc1</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'è¿™æ®µå†è®¾ç½®ï¼š'</span><span class="p">).</span><span class="n">add_run</span><span class="p">(</span><span class="s">'è¿™é‡Œè®¾ç½®ç²—ä½“'</span><span class="p">).</span><span class="n">bold</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1"># è®¾ç½®å­—ä½“å¸¦ä¸‹åˆ’çº¿
</span><span class="n">run</span> <span class="o">=</span> <span class="n">doc1</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'è¿™æ®µä¸ºä¸‹åˆ’çº¿ï¼š'</span><span class="p">).</span><span class="n">add_run</span><span class="p">(</span><span class="s">'è¿™é‡Œè®¾ç½®å¸¦ä¸‹åˆ’çº¿'</span><span class="p">).</span><span class="n">underline</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1"># è®¾ç½®å­—ä½“é¢œè‰²
</span><span class="n">run</span> <span class="o">=</span> <span class="n">doc1</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'è¿™æ®µå­—ä½“ä¸ºçº¢è‰²ï¼š'</span><span class="p">).</span><span class="n">add_run</span><span class="p">(</span><span class="s">'è¿™é‡Œè®¾ç½®å­—ä½“ä¸ºçº¢è‰²'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">color</span><span class="p">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">)</span>

<span class="c1"># å¢åŠ å¼•ç”¨
</span><span class="n">doc1</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'è¿™é‡Œæ˜¯æˆ‘ä»¬å¼•ç”¨çš„ä¸€æ®µè¯ï¼šäººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨Pythonã€‚'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'Intense Quote'</span><span class="p">)</span>

<span class="c1"># ä¿å­˜æ–‡ä»¶
</span><span class="n">doc1</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'word1.docx'</span><span class="p">)</span>
</code></pre></div></div>

<p>ä¸Šé¢ä»£ç ä¸»è¦æ˜¯é’ˆå¯¹æ®µè½å­—ä½“çš„å„ç§è®¾ç½®ï¼Œæ¯æ®µä»£ç éƒ½æ ‡æœ‰æ³¨é‡Šåº”è¯¥æ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œç°åœ¨é€šè¿‡å‘½ä»¤ <code class="highlighter-rouge">python word_1.py </code> è¿è¡Œç¨‹åºçœ‹ä¸‹æ•ˆæœï¼š</p>

<p><img src="http://www.justdopython.com/assets/images/2019/python/python_word_03.png" alt="å­—ä½“å¼•ç”¨" /></p>

<h3 id="é¡¹ç›®åˆ—è¡¨">é¡¹ç›®åˆ—è¡¨</h3>

<p>æˆ‘ä»¬å¹³æ—¶åœ¨ä½¿ç”¨ Word æ—¶ï¼Œä¸ºäº†èƒ½å±•ç¤ºæ›´æ¸…æ™°ï¼Œä¼šç”¨åˆ°é¡¹ç›®ç¬¦å·å’Œç¼–å·ï¼Œå°†å†…å®¹é€šè¿‡åˆ—è¡¨çš„æ–¹å¼å±•ç¤ºå‡ºæ¥ï¼Œä¸‹é¢æˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ–‡ä»¶ <code class="highlighter-rouge">word_2.py</code> å¹¶ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># word_2.py
</span>
<span class="c1"># å¯¼å…¥åº“
</span><span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Pt</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Inches</span>
<span class="kn">from</span> <span class="nn">docx.oxml.ns</span> <span class="kn">import</span> <span class="n">qn</span>

<span class="c1"># æ–°å»ºæ–‡æ¡£
</span><span class="n">doc2</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>

<span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'å“ªä¸ªä¸æ˜¯æ°´æœï¼š'</span><span class="p">)</span>

<span class="c1"># å¢åŠ æ— åºåˆ—è¡¨
</span><span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s">'è‹¹æœ'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'List Bullet'</span>
<span class="p">)</span>
<span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s">'é¦™è•‰'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'List Bullet'</span>
<span class="p">)</span>
<span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s">'é¦„ç‚–'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'List Bullet'</span>
<span class="p">)</span>

<span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'2020å¹´åº¦è®¡åˆ’ï¼š'</span><span class="p">)</span>
<span class="c1"># å¢åŠ æœ‰åºåˆ—è¡¨
</span><span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s">'æ¯å‘¨å¥èº«ä¸€å¤©'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'List Number'</span>
<span class="p">)</span>
<span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s">'å­¦ä¹ 50æœ¬ä¹¦'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'List Number'</span>
<span class="p">)</span>
<span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s">'å‡å°‘åŠ ç­æ—¶é—´'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'List Number'</span>
<span class="p">)</span>

<span class="c1"># ä¿å­˜æ–‡ä»¶
</span><span class="n">doc2</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'word2.docx'</span><span class="p">)</span>
</code></pre></div></div>

<p>ç°åœ¨é€šè¿‡å‘½ä»¤ <code class="highlighter-rouge">python word_2.py </code> è¿è¡Œç¨‹åºçœ‹ä¸‹æ•ˆæœï¼š</p>

<p><img src="http://www.justdopython.com/assets/images/2019/python/python_word_05.png" alt="é¡¹ç›®åˆ—è¡¨" /></p>

<h3 id="å›¾ç‰‡å’Œè¡¨æ ¼">å›¾ç‰‡å’Œè¡¨æ ¼</h3>

<p>æˆ‘ä»¬å¹³æ—¶ç¼–è¾‘æ–‡ç« æ—¶ï¼Œæ’å…¥å›¾ç‰‡å’Œè¡¨æ ¼ä¹Ÿæ˜¯ç»å¸¸ä½¿ç”¨åˆ°çš„ï¼Œé‚£ç”¨ Python è¯¥å¦‚ä½•æ“ä½œæ’å…¥å›¾ç‰‡å’Œè¡¨æ ¼ï¼Ÿé¦–å…ˆæˆ‘ä»¬éšä¾¿æ‰¾äº†ä¸ªå›¾ç‰‡ï¼Œæˆ‘è¿™ç”¨äº† Python å®‰è£…æ—¶çš„ä¸€å¼ æˆªå›¾ï¼Œæ–‡ä»¶åä¸º <code class="highlighter-rouge">python_install.png</code>ï¼Œç„¶ååœ¨ <code class="highlighter-rouge">word_2.py</code> æ–‡ä»¶ä¸­å¢åŠ å¦‚ä¸‹ä»£ç ï¼š</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># word_2.py
</span>
<span class="c1"># å¯¼å…¥åº“
</span><span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Pt</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Inches</span>
<span class="kn">from</span> <span class="nn">docx.oxml.ns</span> <span class="kn">import</span> <span class="n">qn</span>

<span class="c1"># æ–°å»ºæ–‡æ¡£
</span><span class="n">doc2</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>

<span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'å“ªä¸ªä¸æ˜¯æ°´æœï¼š'</span><span class="p">)</span>

<span class="c1"># å¢åŠ æ— åºåˆ—è¡¨
</span><span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s">'è‹¹æœ'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'List Bullet'</span>
<span class="p">)</span>
<span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s">'é¦™è•‰'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'List Bullet'</span>
<span class="p">)</span>
<span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s">'é¦„ç‚–'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'List Bullet'</span>
<span class="p">)</span>

<span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'2020å¹´åº¦è®¡åˆ’ï¼š'</span><span class="p">)</span>
<span class="c1"># å¢åŠ æœ‰åºåˆ—è¡¨
</span><span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s">'æ¯å‘¨å¥èº«ä¸€å¤©'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'List Number'</span>
<span class="p">)</span>
<span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s">'å­¦ä¹ 50æœ¬ä¹¦'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'List Number'</span>
<span class="p">)</span>
<span class="n">doc2</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s">'å‡å°‘åŠ ç­æ—¶é—´'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'List Number'</span>
<span class="p">)</span>

<span class="n">doc2</span><span class="p">.</span><span class="n">add_heading</span><span class="p">(</span><span class="s">'å›¾ç‰‡'</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># å¢åŠ å›¾åƒ
</span><span class="n">doc2</span><span class="p">.</span><span class="n">add_picture</span><span class="p">(</span><span class="s">'python_install.png'</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">Inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">))</span>

<span class="n">doc2</span><span class="p">.</span><span class="n">add_heading</span><span class="p">(</span><span class="s">'è¡¨æ ¼'</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># å¢åŠ è¡¨æ ¼ï¼Œè¿™æ˜¯è¡¨æ ¼å¤´
</span><span class="n">table</span> <span class="o">=</span> <span class="n">doc2</span><span class="p">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">hdr_cells</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">cells</span>
<span class="n">hdr_cells</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">text</span> <span class="o">=</span> <span class="s">'ç¼–å·'</span>
<span class="n">hdr_cells</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">text</span> <span class="o">=</span> <span class="s">'å§“å'</span>
<span class="n">hdr_cells</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">text</span> <span class="o">=</span> <span class="s">'èŒä¸š'</span>

<span class="c1"># è¿™æ˜¯è¡¨æ ¼æ•°æ®
</span><span class="n">records</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'å¼ ä¸‰'</span><span class="p">,</span> <span class="s">'ç”µå·¥'</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'å¼ äº”'</span><span class="p">,</span> <span class="s">'è€æ¿'</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s">'é©¬å…­'</span><span class="p">,</span> <span class="s">'IT'</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># éå†æ•°æ®å¹¶å±•ç¤º
</span><span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">work</span> <span class="ow">in</span> <span class="n">records</span><span class="p">:</span>
    <span class="n">row_cells</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">add_row</span><span class="p">().</span><span class="n">cells</span>
    <span class="n">row_cells</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">row_cells</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">text</span> <span class="o">=</span> <span class="n">name</span>
    <span class="n">row_cells</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">text</span> <span class="o">=</span> <span class="n">work</span>

<span class="c1"># æ‰‹åŠ¨å¢åŠ åˆ†é¡µ
</span><span class="n">doc2</span><span class="p">.</span><span class="n">add_page_break</span><span class="p">()</span>

<span class="c1"># ä¿å­˜æ–‡ä»¶
</span><span class="n">doc2</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'word2.docx'</span><span class="p">)</span>
</code></pre></div></div>

<p>OKï¼Œç°åœ¨å†æ¥è®©æˆ‘ä»¬å†æ¥çœ‹ä¸‹æ•ˆæœï¼š</p>

<p><img src="http://www.justdopython.com/assets/images/2019/python/python_word_06.png" alt="å›¾ç‰‡è¡¨æ ¼" /></p>

<h2 id="è¯»å–-word-æ–‡ä»¶">è¯»å– Word æ–‡ä»¶</h2>

<p>ä¸Šé¢å†™äº†å¾ˆå¤šç”¨ Python åˆ›å»ºç©ºç™½ Word æ–‡ä»¶æ ¼å¼åŒ–å­—ä½“å¹¶ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å†ç®€å•ä»‹ç»ä¸‹å¦‚ä½•è¯»å–å·²æœ‰çš„ Word æ–‡ä»¶ï¼Œè¯·çœ‹å¦‚ä¸‹ä»£ç ï¼š</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># word_3.py
</span>
<span class="c1"># å¼•å…¥åº“
</span><span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>

<span class="c1"># æ‰“å¼€æ–‡æ¡£1
</span><span class="n">doc1</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="s">'word1.docx'</span><span class="p">)</span>

<span class="c1"># è¯»å–æ¯æ®µå†…å®¹
</span><span class="n">pl</span> <span class="o">=</span> <span class="p">[</span> <span class="n">paragraph</span><span class="p">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">paragraph</span> <span class="ow">in</span> <span class="n">doc1</span><span class="p">.</span><span class="n">paragraphs</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="s">'###### è¾“å‡ºword1æ–‡ç« å†…å®¹'</span><span class="p">)</span>
<span class="c1"># è¾“å‡ºè¯»å–åˆ°çš„å†…å®¹
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pl</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>


<span class="c1"># æ‰“å¼€æ–‡æ¡£2
</span><span class="n">doc2</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="s">'word2.docx'</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">###### è¾“å‡ºword2æ–‡ç« å†…å®¹'</span><span class="p">)</span>

<span class="n">pl2</span> <span class="o">=</span> <span class="p">[</span> <span class="n">paragraph</span><span class="p">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">paragraph</span> <span class="ow">in</span> <span class="n">doc2</span><span class="p">.</span><span class="n">paragraphs</span><span class="p">]</span>

<span class="c1"># è¾“å‡ºè¯»å–åˆ°çš„å†…å®¹
</span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">pl2</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>

<span class="c1"># è¯»å–è¡¨æ ¼ææ–™ï¼Œå¹¶è¾“å‡ºç»“æœ
</span><span class="n">tables</span> <span class="o">=</span> <span class="p">[</span><span class="n">table</span> <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">doc2</span><span class="p">.</span><span class="n">tables</span><span class="p">]</span>
<span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="p">.</span><span class="n">rows</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">.</span><span class="n">cells</span><span class="p">:</span>
            <span class="k">print</span> <span class="p">(</span><span class="n">cell</span><span class="p">.</span><span class="n">text</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s">'  '</span><span class="p">)</span>
        <span class="k">print</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
</code></pre></div></div>

<p>ä»¥ä¸Šä»£ç æ˜¯å°†ä¹‹å‰æˆ‘ä»¬è¾“å‡ºçš„ä¸¤ä¸ªæ–‡æ¡£å†…å®¹éƒ½è¯»å–å‡ºæ¥ï¼Œå½“ç„¶è¿™é‡Œåªæ˜¯æ‰“å°åˆ°æ§åˆ¶å°ï¼Œå¹¶æ²¡æœ‰åšå…¶ä»–å¤„ç†ã€‚ç°åœ¨æˆ‘ä»¬æ¥æ‰§è¡Œå‘½ä»¤ <code class="highlighter-rouge">python word_3.py</code> æŠŠä»£ç æ‰§è¡Œçœ‹ä¸‹ç»“æœï¼š</p>

<p><img src="http://www.justdopython.com/assets/images/2019/python/python_word_07.png" alt="è¯»å–å¹¶æ‰“å°" /></p>

<h2 id="æ€»ç»“">æ€»ç»“</h2>

<p>æœ¬æ–‡ä¸ºå¤§å®¶ä»‹ç»äº† Python ä¸­å¦‚ä½•æ“ä½œ Word æ–‡æ¡£ï¼Œå…¶ä¸­å†™å…¥æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬å¸¸ç”¨å„ç§æ ‡é¢˜æ®µè½å­—ä½“è®¾ç½®ç­‰ï¼Œä¼šæ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œåªæ˜¯ç®€å•ä»‹ç»äº†æœ€å¸¸ç”¨çš„å‡ ç§æ–¹æ³•ï¼Œå¦‚æœæƒ³äº†è§£æ›´å¤šè¯·å‚è€ƒæ–‡æœ«å®˜ç½‘ä»‹ç»ï¼Œä¹‹åä¼šä¸ºå¤§å®¶ä»‹ç»å…¶ä»–ç±»å‹æ–‡ä»¶çš„æ“ä½œæ–¹å¼ï¼Œå¸Œæœ›å¤§å®¶èƒ½å¤šå¤šå…³æ³¨ã€‚</p>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>

<p>python-excel å®˜ç½‘ï¼šhttps://python-docx.readthedocs.io/en/latest/index.html</p>

<blockquote>
  <p>ç¤ºä¾‹ä»£ç ï¼šhttps://github.com/JustDoPython/python-100-day</p>
</blockquote>
:ET