I"Ò<p>RabbitMQ å³ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸»è¦æ˜¯ç”¨æ¥å®ç°åº”ç”¨ç¨‹åºçš„å¼‚æ­¥å’Œè§£è€¦ï¼ŒåŒæ—¶ä¹Ÿèƒ½èµ·åˆ°æ¶ˆæ¯ç¼“å†²ï¼Œæ¶ˆæ¯åˆ†å‘çš„ä½œç”¨ã€‚</p>

<p>æ¶ˆæ¯ä¸­é—´ä»¶åœ¨äº’è”ç½‘å…¬å¸çš„ä½¿ç”¨ä¸­è¶Šæ¥è¶Šå¤šï¼Œåˆšæ‰è¿˜çœ‹åˆ°æ–°é—»é˜¿é‡Œå°† RocketMQ æçŒ®ç»™äº† Apacheï¼Œå½“ç„¶äº†ä»Šå¤©çš„ä¸»è§’è¿˜æ˜¯è®² RabbitMQã€‚æ¶ˆæ¯ä¸­é—´ä»¶æœ€ä¸»è¦çš„ä½œç”¨æ˜¯è§£è€¦ï¼Œä¸­é—´ä»¶æœ€æ ‡å‡†çš„ç”¨æ³•æ˜¯ç”Ÿäº§è€…ç”Ÿäº§æ¶ˆæ¯ä¼ é€åˆ°é˜Ÿåˆ—ï¼Œæ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­æ‹¿å–æ¶ˆæ¯å¹¶å¤„ç†ï¼Œç”Ÿäº§è€…ä¸ç”¨å…³å¿ƒæ˜¯è°æ¥æ¶ˆè´¹ï¼Œæ¶ˆè´¹è€…ä¸ç”¨å…³å¿ƒè°åœ¨ç”Ÿäº§æ¶ˆæ¯ï¼Œä»è€Œè¾¾åˆ°è§£è€¦çš„ç›®çš„ã€‚åœ¨åˆ†å¸ƒå¼çš„ç³»ç»Ÿä¸­ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ä¹Ÿä¼šè¢«ç”¨åœ¨å¾ˆå¤šå…¶å®ƒçš„æ–¹é¢ï¼Œæ¯”å¦‚ï¼šåˆ†å¸ƒå¼äº‹åŠ¡çš„æ”¯æŒï¼ŒRPC çš„è°ƒç”¨ç­‰ç­‰ã€‚</p>

<p>ä»¥å‰ä¸€ç›´ä½¿ç”¨çš„æ˜¯ ActiveMQï¼Œåœ¨å®é™…çš„ç”Ÿäº§ä½¿ç”¨ä¸­ä¹Ÿå‡ºç°äº†ä¸€äº›å°é—®é¢˜ï¼Œåœ¨ç½‘ç»œæŸ¥é˜…äº†å¾ˆå¤šçš„èµ„æ–™åï¼Œå†³å®šå°è¯•ä½¿ç”¨ RabbitMQ æ¥æ›¿æ¢ ActiveMQï¼ŒRabbitMQ çš„é«˜å¯ç”¨æ€§ã€é«˜æ€§èƒ½ã€çµæ´»æ€§ç­‰ä¸€äº›ç‰¹ç‚¹å¸å¼•äº†æˆ‘ä»¬ï¼ŒæŸ¥é˜…äº†ä¸€äº›èµ„æ–™æ•´ç†å‡ºæ­¤æ–‡ã€‚</p>

<h2 id="rabbitmq-ä»‹ç»">RabbitMQ ä»‹ç»</h2>

<p>RabbitMQ æ˜¯å®ç° AMQPï¼ˆé«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼‰çš„æ¶ˆæ¯ä¸­é—´ä»¶çš„ä¸€ç§ï¼Œæœ€åˆèµ·æºäºé‡‘èç³»ç»Ÿï¼Œç”¨äºåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å­˜å‚¨è½¬å‘æ¶ˆæ¯ï¼Œåœ¨æ˜“ç”¨æ€§ã€æ‰©å±•æ€§ã€é«˜å¯ç”¨æ€§ç­‰æ–¹é¢è¡¨ç°ä¸ä¿—ã€‚ RabbitMQ ä¸»è¦æ˜¯ä¸ºäº†å®ç°ç³»ç»Ÿä¹‹é—´çš„åŒå‘è§£è€¦è€Œå®ç°çš„ã€‚å½“ç”Ÿäº§è€…å¤§é‡äº§ç”Ÿæ•°æ®æ—¶ï¼Œæ¶ˆè´¹è€…æ— æ³•å¿«é€Ÿæ¶ˆè´¹ï¼Œé‚£ä¹ˆéœ€è¦ä¸€ä¸ªä¸­é—´å±‚ã€‚ä¿å­˜è¿™ä¸ªæ•°æ®ã€‚</p>

<p>AMQPï¼Œå³ Advanced Message Queuing Protocolï¼Œé«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼Œæ˜¯åº”ç”¨å±‚åè®®çš„ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œä¸ºé¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶è®¾è®¡ã€‚æ¶ˆæ¯ä¸­é—´ä»¶ä¸»è¦ç”¨äºç»„ä»¶ä¹‹é—´çš„è§£è€¦ï¼Œæ¶ˆæ¯çš„å‘é€è€…æ— éœ€çŸ¥é“æ¶ˆæ¯ä½¿ç”¨è€…çš„å­˜åœ¨ï¼Œåä¹‹äº¦ç„¶ã€‚AMQP çš„ä¸»è¦ç‰¹å¾æ˜¯é¢å‘æ¶ˆæ¯ã€é˜Ÿåˆ—ã€è·¯ç”±ï¼ˆåŒ…æ‹¬ç‚¹å¯¹ç‚¹å’Œå‘å¸ƒ/è®¢é˜…ï¼‰ã€å¯é æ€§ã€å®‰å…¨ã€‚</p>

<p>RabbitMQ æ˜¯ä¸€ä¸ªå¼€æºçš„ AMQP å®ç°ï¼ŒæœåŠ¡å™¨ç«¯ç”¨Erlangè¯­è¨€ç¼–å†™ï¼Œæ”¯æŒå¤šç§å®¢æˆ·ç«¯ï¼Œå¦‚ï¼šPythonã€Rubyã€.NETã€Javaã€JMSã€Cã€PHPã€ActionScriptã€XMPPã€STOMP ç­‰ï¼Œæ”¯æŒ AJAXã€‚ç”¨äºåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å­˜å‚¨è½¬å‘æ¶ˆæ¯ï¼Œåœ¨æ˜“ç”¨æ€§ã€æ‰©å±•æ€§ã€é«˜å¯ç”¨æ€§ç­‰æ–¹é¢è¡¨ç°ä¸ä¿—ã€‚</p>

<h3 id="ç›¸å…³æ¦‚å¿µ">ç›¸å…³æ¦‚å¿µ</h3>

<p>é€šå¸¸æˆ‘ä»¬è°ˆåˆ°é˜Ÿåˆ—æœåŠ¡, ä¼šæœ‰ä¸‰ä¸ªæ¦‚å¿µï¼š å‘æ¶ˆæ¯è€…ã€é˜Ÿåˆ—ã€æ”¶æ¶ˆæ¯è€…ï¼ŒRabbitMQ åœ¨è¿™ä¸ªåŸºæœ¬æ¦‚å¿µä¹‹ä¸Š, å¤šåšäº†ä¸€å±‚æŠ½è±¡, åœ¨å‘æ¶ˆæ¯è€…å’Œ é˜Ÿåˆ—ä¹‹é—´, åŠ å…¥äº†äº¤æ¢å™¨ (Exchange). è¿™æ ·å‘æ¶ˆæ¯è€…å’Œé˜Ÿåˆ—å°±æ²¡æœ‰ç›´æ¥è”ç³», è½¬è€Œå˜æˆå‘æ¶ˆæ¯è€…æŠŠæ¶ˆæ¯ç»™äº¤æ¢å™¨, äº¤æ¢å™¨æ ¹æ®è°ƒåº¦ç­–ç•¥å†æŠŠæ¶ˆæ¯å†ç»™é˜Ÿåˆ—ã€‚</p>

<p><img src="http://favorites.ren/assets/images/2016/RabbitMQ01.png" alt="" /></p>

<ul>
  <li>å·¦ä¾§ P ä»£è¡¨ ç”Ÿäº§è€…ï¼Œä¹Ÿå°±æ˜¯å¾€ RabbitMQ å‘æ¶ˆæ¯çš„ç¨‹åºã€‚</li>
  <li>ä¸­é—´å³æ˜¯ RabbitMQï¼Œ<em>å…¶ä¸­åŒ…æ‹¬äº† äº¤æ¢æœº å’Œ é˜Ÿåˆ—ã€‚</em></li>
  <li>å³ä¾§ C ä»£è¡¨ æ¶ˆè´¹è€…ï¼Œä¹Ÿå°±æ˜¯å¾€ RabbitMQ æ‹¿æ¶ˆæ¯çš„ç¨‹åºã€‚</li>
</ul>

<p>é‚£ä¹ˆï¼Œ<em>å…¶ä¸­æ¯”è¾ƒé‡è¦çš„æ¦‚å¿µæœ‰ 4 ä¸ªï¼Œåˆ†åˆ«ä¸ºï¼šè™šæ‹Ÿä¸»æœºï¼Œäº¤æ¢æœºï¼Œé˜Ÿåˆ—ï¼Œå’Œç»‘å®šã€‚</em></p>

<ul>
  <li>è™šæ‹Ÿä¸»æœºï¼šä¸€ä¸ªè™šæ‹Ÿä¸»æœºæŒæœ‰ä¸€ç»„äº¤æ¢æœºã€é˜Ÿåˆ—å’Œç»‘å®šã€‚ä¸ºä»€ä¹ˆéœ€è¦å¤šä¸ªè™šæ‹Ÿä¸»æœºå‘¢ï¼Ÿå¾ˆç®€å•ï¼Œ RabbitMQ å½“ä¸­ï¼Œ<em>ç”¨æˆ·åªèƒ½åœ¨è™šæ‹Ÿä¸»æœºçš„ç²’åº¦è¿›è¡Œæƒé™æ§åˆ¶ã€‚</em> å› æ­¤ï¼Œå¦‚æœéœ€è¦ç¦æ­¢Aç»„è®¿é—®Bç»„çš„äº¤æ¢æœº/é˜Ÿåˆ—/ç»‘å®šï¼Œå¿…é¡»ä¸ºAå’ŒBåˆ†åˆ«åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿä¸»æœºã€‚æ¯ä¸€ä¸ª RabbitMQ æœåŠ¡å™¨éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„è™šæ‹Ÿä¸»æœºâ€œ/â€ã€‚</li>
  <li>äº¤æ¢æœºï¼š<em>Exchange ç”¨äºè½¬å‘æ¶ˆæ¯ï¼Œä½†æ˜¯å®ƒä¸ä¼šåšå­˜å‚¨</em> ï¼Œå¦‚æœæ²¡æœ‰ Queue bind åˆ° Exchange çš„è¯ï¼Œå®ƒä¼šç›´æ¥ä¸¢å¼ƒæ‰ Producer å‘é€è¿‡æ¥çš„æ¶ˆæ¯ã€‚
è¿™é‡Œæœ‰ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„æ¦‚å¿µï¼š<strong>è·¯ç”±é”®</strong> ã€‚æ¶ˆæ¯åˆ°äº¤æ¢æœºçš„æ—¶å€™ï¼Œäº¤äº’æœºä¼šè½¬å‘åˆ°å¯¹åº”çš„é˜Ÿåˆ—ä¸­ï¼Œé‚£ä¹ˆç©¶ç«Ÿè½¬å‘åˆ°å“ªä¸ªé˜Ÿåˆ—ï¼Œå°±è¦æ ¹æ®è¯¥è·¯ç”±é”®ã€‚</li>
  <li>ç»‘å®šï¼šä¹Ÿå°±æ˜¯äº¤æ¢æœºéœ€è¦å’Œé˜Ÿåˆ—ç›¸ç»‘å®šï¼Œè¿™å…¶ä¸­å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæ˜¯å¤šå¯¹å¤šçš„å…³ç³»ã€‚</li>
</ul>

<h3 id="äº¤æ¢æœºexchange">äº¤æ¢æœº(Exchange)</h3>

<p>äº¤æ¢æœºçš„åŠŸèƒ½ä¸»è¦æ˜¯æ¥æ”¶æ¶ˆæ¯å¹¶ä¸”è½¬å‘åˆ°ç»‘å®šçš„é˜Ÿåˆ—ï¼Œäº¤æ¢æœºä¸å­˜å‚¨æ¶ˆæ¯ï¼Œåœ¨å¯ç”¨ackæ¨¡å¼åï¼Œäº¤æ¢æœºæ‰¾ä¸åˆ°é˜Ÿåˆ—ä¼šè¿”å›é”™è¯¯ã€‚äº¤æ¢æœºæœ‰å››ç§ç±»å‹ï¼šDirect, topic, Headers and Fanout</p>

<ul>
  <li>Directï¼šdirect ç±»å‹çš„è¡Œä¸ºæ˜¯â€å…ˆåŒ¹é…, å†æŠ•é€â€. å³åœ¨ç»‘å®šæ—¶è®¾å®šä¸€ä¸ª <strong>routing_key</strong>, æ¶ˆæ¯çš„<strong>routing_key</strong> åŒ¹é…æ—¶, æ‰ä¼šè¢«äº¤æ¢å™¨æŠ•é€åˆ°ç»‘å®šçš„é˜Ÿåˆ—ä¸­å».</li>
  <li>Topicï¼šæŒ‰è§„åˆ™è½¬å‘æ¶ˆæ¯ï¼ˆæœ€çµæ´»ï¼‰</li>
  <li>Headersï¼šè®¾ç½® header attribute å‚æ•°ç±»å‹çš„äº¤æ¢æœº</li>
  <li>Fanoutï¼šè½¬å‘æ¶ˆæ¯åˆ°æ‰€æœ‰ç»‘å®šé˜Ÿåˆ—</li>
</ul>

<p><strong>Direct Exchange</strong></p>

<p>Direct  Exchange æ˜¯ RabbitMQ é»˜è®¤çš„äº¤æ¢æœºæ¨¡å¼ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„æ¨¡å¼ï¼Œæ ¹æ®keyå…¨æ–‡åŒ¹é…å»å¯»æ‰¾é˜Ÿåˆ—ã€‚<br />
<img src="http://favorites.ren/assets/images/2016/rabbitMq_direct.png" alt="" /></p>

<p>ç¬¬ä¸€ä¸ª X - Q1 å°±æœ‰ä¸€ä¸ª binding keyï¼Œåå­—ä¸º orangeï¼› X - Q2 å°±æœ‰ 2 ä¸ª binding keyï¼Œåå­—ä¸º black å’Œ greenã€‚<em>å½“æ¶ˆæ¯ä¸­çš„ è·¯ç”±é”® å’Œ è¿™ä¸ª binding key å¯¹åº”ä¸Šçš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±çŸ¥é“äº†è¯¥æ¶ˆæ¯å»åˆ°å“ªä¸€ä¸ªé˜Ÿåˆ—ä¸­ã€‚</em></p>

<p>Psï¼šä¸ºä»€ä¹ˆ X åˆ° Q2 è¦æœ‰ blackï¼Œgreenï¼Œ2ä¸ª binding keyå‘¢ï¼Œä¸€ä¸ªä¸å°±è¡Œäº†å—ï¼Ÿ - è¿™ä¸ªä¸»è¦æ˜¯å› ä¸ºå¯èƒ½åˆæœ‰ Q3ï¼Œè€ŒQ3åªæ¥å— black çš„ä¿¡æ¯ï¼Œè€ŒQ2ä¸ä»…æ¥å—black çš„ä¿¡æ¯ï¼Œè¿˜æ¥å— green çš„ä¿¡æ¯ã€‚</p>

<p><strong>Topic Exchange</strong></p>

<p><em>Topic Exchange è½¬å‘æ¶ˆæ¯ä¸»è¦æ˜¯æ ¹æ®é€šé…ç¬¦ã€‚</em> åœ¨è¿™ç§äº¤æ¢æœºä¸‹ï¼Œé˜Ÿåˆ—å’Œäº¤æ¢æœºçš„ç»‘å®šä¼šå®šä¹‰ä¸€ç§è·¯ç”±æ¨¡å¼ï¼Œé‚£ä¹ˆï¼Œé€šé…ç¬¦å°±è¦åœ¨è¿™ç§è·¯ç”±æ¨¡å¼å’Œè·¯ç”±é”®ä¹‹é—´åŒ¹é…åäº¤æ¢æœºæ‰èƒ½è½¬å‘æ¶ˆæ¯ã€‚</p>

<p>åœ¨è¿™ç§äº¤æ¢æœºæ¨¡å¼ä¸‹ï¼š</p>

<ul>
  <li>è·¯ç”±é”®å¿…é¡»æ˜¯ä¸€ä¸²å­—ç¬¦ï¼Œç”¨å¥å·ï¼ˆ<code class="highlighter-rouge">.</code>ï¼‰ éš”å¼€ï¼Œæ¯”å¦‚è¯´ agreements.usï¼Œæˆ–è€… agreements.eu.stockholm ç­‰ã€‚</li>
  <li>è·¯ç”±æ¨¡å¼å¿…é¡»åŒ…å«ä¸€ä¸ª æ˜Ÿå·ï¼ˆ<code class="highlighter-rouge">*</code>ï¼‰ï¼Œä¸»è¦ç”¨äºåŒ¹é…è·¯ç”±é”®æŒ‡å®šä½ç½®çš„ä¸€ä¸ªå•è¯ï¼Œæ¯”å¦‚è¯´ï¼Œä¸€ä¸ªè·¯ç”±æ¨¡å¼æ˜¯è¿™æ ·å­ï¼šagreements..b.*ï¼Œé‚£ä¹ˆå°±åªèƒ½åŒ¹é…è·¯ç”±é”®æ˜¯è¿™æ ·å­çš„ï¼šç¬¬ä¸€ä¸ªå•è¯æ˜¯ agreementsï¼Œç¬¬å››ä¸ªå•è¯æ˜¯ bã€‚ äº•å·ï¼ˆ#ï¼‰å°±è¡¨ç¤ºç›¸å½“äºä¸€ä¸ªæˆ–è€…å¤šä¸ªå•è¯ï¼Œä¾‹å¦‚ä¸€ä¸ªåŒ¹é…æ¨¡å¼æ˜¯ agreements.eu.berlin.#ï¼Œé‚£ä¹ˆï¼Œä»¥agreements.eu.berlin å¼€å¤´çš„è·¯ç”±é”®éƒ½æ˜¯å¯ä»¥çš„ã€‚</li>
</ul>

<p>å…·ä½“ä»£ç å‘é€çš„æ—¶å€™è¿˜æ˜¯ä¸€æ ·ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºäº¤æ¢æœºï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤º routing keyï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å³æ¶ˆæ¯ã€‚å¦‚ä¸‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rabbitTemplate.convertAndSend("testTopicExchange","key1.a.c.key2", " this is  RabbitMQ!");
</code></pre></div></div>

<p>topic å’Œ direct ç±»ä¼¼, åªæ˜¯åŒ¹é…ä¸Šæ”¯æŒäº†â€æ¨¡å¼â€, åœ¨â€ç‚¹åˆ†â€çš„ routing_key å½¢å¼ä¸­, å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªé€šé…ç¬¦:</p>

<ul>
  <li><code class="highlighter-rouge">*</code>è¡¨ç¤ºä¸€ä¸ªè¯.</li>
  <li><code class="highlighter-rouge">#</code>è¡¨ç¤ºé›¶ä¸ªæˆ–å¤šä¸ªè¯.</li>
</ul>

<p><strong>Headers Exchange</strong></p>

<p>headers ä¹Ÿæ˜¯æ ¹æ®è§„åˆ™åŒ¹é…, ç›¸è¾ƒäº direct å’Œ topic å›ºå®šåœ°ä½¿ç”¨ routing_key , headers åˆ™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰åŒ¹é…è§„åˆ™çš„ç±»å‹.
åœ¨é˜Ÿåˆ—ä¸äº¤æ¢å™¨ç»‘å®šæ—¶, ä¼šè®¾å®šä¸€ç»„é”®å€¼å¯¹è§„åˆ™, æ¶ˆæ¯ä¸­ä¹ŸåŒ…æ‹¬ä¸€ç»„é”®å€¼å¯¹( headers å±æ€§), å½“è¿™äº›é”®å€¼å¯¹æœ‰ä¸€å¯¹, æˆ–å…¨éƒ¨åŒ¹é…æ—¶, æ¶ˆæ¯è¢«æŠ•é€åˆ°å¯¹åº”é˜Ÿåˆ—.</p>

<p><strong>Fanout Exchange</strong></p>

<p>Fanout Exchange æ¶ˆæ¯å¹¿æ’­çš„æ¨¡å¼ï¼Œä¸ç®¡è·¯ç”±é”®æˆ–è€…æ˜¯è·¯ç”±æ¨¡å¼ï¼Œ<em>ä¼šæŠŠæ¶ˆæ¯å‘ç»™ç»‘å®šç»™å®ƒçš„å…¨éƒ¨é˜Ÿåˆ—</em>ï¼Œå¦‚æœé…ç½®äº† routing_key ä¼šè¢«å¿½ç•¥ã€‚</p>

<h2 id="spring-boot-é›†æˆ-rabbitmq">Spring Boot é›†æˆ RabbitMQ</h2>

<p>Spring Boot é›†æˆ RabbitMQ éå¸¸ç®€å•ï¼Œå¦‚æœåªæ˜¯ç®€å•çš„ä½¿ç”¨é…ç½®éå¸¸å°‘ï¼ŒSpring Boot æä¾›äº†<code class="highlighter-rouge">spring-boot-starter-amqp</code> é¡¹ç›®å¯¹æ¶ˆæ¯å„ç§æ”¯æŒã€‚</p>

<h3 id="ç®€å•ä½¿ç”¨">ç®€å•ä½¿ç”¨</h3>

<p>1ã€é…ç½® Pom åŒ…ï¼Œä¸»è¦æ˜¯æ·»åŠ  <code class="highlighter-rouge">spring-boot-starter-amqp</code> çš„æ”¯æŒ</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-amqp<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<p>2ã€é…ç½®æ–‡ä»¶</p>

<p>é…ç½® RabbitMQ çš„å®‰è£…åœ°å€ã€ç«¯å£ä»¥åŠè´¦æˆ·ä¿¡æ¯</p>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">spring.application.name</span><span class="p">=</span><span class="s">Spring-boot-rabbitmq</span>

<span class="py">spring.rabbitmq.host</span><span class="p">=</span><span class="s">192.168.0.86</span>
<span class="py">spring.rabbitmq.port</span><span class="p">=</span><span class="s">5672</span>
<span class="py">spring.rabbitmq.username</span><span class="p">=</span><span class="s">admin</span>
<span class="py">spring.rabbitmq.password</span><span class="p">=</span><span class="s">123456</span>
</code></pre></div></div>

<p>3ã€é˜Ÿåˆ—é…ç½®</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RabbitConfig</span> <span class="o">{</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">Queue</span> <span class="nf">Queue</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Queue</span><span class="o">(</span><span class="s">"hello"</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>3ã€å‘é€è€…</p>

<p>rabbitTemplate æ˜¯ Spring Boot æä¾›çš„é»˜è®¤å®ç°</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloSender</span> <span class="o">{</span>

	<span class="nd">@Autowired</span>
	<span class="kd">private</span> <span class="nc">AmqpTemplate</span> <span class="n">rabbitTemplate</span><span class="o">;</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">send</span><span class="o">()</span> <span class="o">{</span>
		<span class="nc">String</span> <span class="n">context</span> <span class="o">=</span> <span class="s">"hello "</span> <span class="o">+</span> <span class="k">new</span> <span class="nc">Date</span><span class="o">();</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Sender : "</span> <span class="o">+</span> <span class="n">context</span><span class="o">);</span>
		<span class="k">this</span><span class="o">.</span><span class="na">rabbitTemplate</span><span class="o">.</span><span class="na">convertAndSend</span><span class="o">(</span><span class="s">"hello"</span><span class="o">,</span> <span class="n">context</span><span class="o">);</span>
	<span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>4ã€æ¥æ”¶è€…</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="nd">@RabbitListener</span><span class="o">(</span><span class="n">queues</span> <span class="o">=</span> <span class="s">"hello"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloReceiver</span> <span class="o">{</span>

    <span class="nd">@RabbitHandler</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="nc">String</span> <span class="n">hello</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Receiver  : "</span> <span class="o">+</span> <span class="n">hello</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>5ã€æµ‹è¯•</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RunWith</span><span class="o">(</span><span class="nc">SpringRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@SpringBootTest</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RabbitMqHelloTest</span> <span class="o">{</span>

	<span class="nd">@Autowired</span>
	<span class="kd">private</span> <span class="nc">HelloSender</span> <span class="n">helloSender</span><span class="o">;</span>

	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">hello</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="n">helloSender</span><span class="o">.</span><span class="na">send</span><span class="o">();</span>
	<span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p>æ³¨æ„ï¼Œå‘é€è€…å’Œæ¥æ”¶è€…çš„ queue name å¿…é¡»ä¸€è‡´ï¼Œä¸ç„¶ä¸èƒ½æ¥æ”¶</p>
</blockquote>

<h3 id="å¤šå¯¹å¤šä½¿ç”¨">å¤šå¯¹å¤šä½¿ç”¨</h3>

<p>ä¸€ä¸ªå‘é€è€…ï¼ŒN ä¸ªæ¥æ”¶è€…æˆ–è€… N ä¸ªå‘é€è€…å’Œ N ä¸ªæ¥æ”¶è€…ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ</p>

<p><strong>ä¸€å¯¹å¤šå‘é€</strong></p>

<p>å¯¹ä¸Šé¢çš„ä»£ç è¿›è¡Œäº†å°æ”¹é€ ï¼Œæ¥æ”¶ç«¯æ³¨å†Œäº†ä¸¤ä¸ª Receiver,Receiver1 å’Œ Receiver2ï¼Œå‘é€ç«¯åŠ å…¥å‚æ•°è®¡æ•°ï¼Œæ¥æ”¶ç«¯æ‰“å°æ¥æ”¶åˆ°çš„å‚æ•°ï¼Œä¸‹é¢æ˜¯æµ‹è¯•ä»£ç ï¼Œå‘é€ä¸€ç™¾æ¡æ¶ˆæ¯ï¼Œæ¥è§‚å¯Ÿä¸¤ä¸ªæ¥æ”¶ç«¯çš„æ‰§è¡Œæ•ˆæœ</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">oneToMany</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
	<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">100</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
		<span class="n">neoSender</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ç»“æœå¦‚ä¸‹ï¼š</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Receiver 1: Spring boot neo queue ****** 11
Receiver 2: Spring boot neo queue ****** 12
Receiver 2: Spring boot neo queue ****** 14
Receiver 1: Spring boot neo queue ****** 13
Receiver 2: Spring boot neo queue ****** 15
Receiver 1: Spring boot neo queue ****** 16
Receiver 1: Spring boot neo queue ****** 18
Receiver 2: Spring boot neo queue ****** 17
Receiver 2: Spring boot neo queue ****** 19
Receiver 1: Spring boot neo queue ****** 20

</code></pre></div></div>

<p>æ ¹æ®è¿”å›ç»“æœå¾—åˆ°ä»¥ä¸‹ç»“è®º</p>
<blockquote>
  <p>ä¸€ä¸ªå‘é€è€…ï¼ŒNä¸ªæ¥å—è€…,ç»è¿‡æµ‹è¯•ä¼šå‡åŒ€çš„å°†æ¶ˆæ¯å‘é€åˆ°Nä¸ªæ¥æ”¶è€…ä¸­</p>
</blockquote>

<p><strong>å¤šå¯¹å¤šå‘é€</strong></p>

<p>å¤åˆ¶äº†ä¸€ä»½å‘é€è€…ï¼ŒåŠ å…¥æ ‡è®°ï¼Œåœ¨ä¸€ç™¾ä¸ªå¾ªç¯ä¸­ç›¸äº’äº¤æ›¿å‘é€</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">manyToMany</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">100</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
			<span class="n">neoSender</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
			<span class="n">neoSender2</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
		<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p>ç»“æœå¦‚ä¸‹ï¼š</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Receiver 1: Spring boot neo queue ****** 20
Receiver 2: Spring boot neo queue ****** 20
Receiver 1: Spring boot neo queue ****** 21
Receiver 2: Spring boot neo queue ****** 21
Receiver 1: Spring boot neo queue ****** 22
Receiver 2: Spring boot neo queue ****** 22
Receiver 1: Spring boot neo queue ****** 23
Receiver 2: Spring boot neo queue ****** 23
Receiver 1: Spring boot neo queue ****** 24
Receiver 2: Spring boot neo queue ****** 24
Receiver 1: Spring boot neo queue ****** 25
Receiver 2: Spring boot neo queue ****** 25
</code></pre></div></div>

<blockquote>
  <p>ç»“è®ºï¼šå’Œä¸€å¯¹å¤šä¸€æ ·ï¼Œæ¥æ”¶ç«¯ä»ç„¶ä¼šå‡åŒ€æ¥æ”¶åˆ°æ¶ˆæ¯</p>
</blockquote>

<h3 id="é«˜çº§ä½¿ç”¨">é«˜çº§ä½¿ç”¨</h3>

<p><strong>å¯¹è±¡çš„æ”¯æŒ</strong></p>

<p>Spring Boot ä»¥åŠå®Œç¾çš„æ”¯æŒå¯¹è±¡çš„å‘é€å’Œæ¥æ”¶ï¼Œä¸éœ€è¦æ ¼å¤–çš„é…ç½®ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å‘é€è€…</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">send</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Sender object: "</span> <span class="o">+</span> <span class="n">user</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
	<span class="k">this</span><span class="o">.</span><span class="na">rabbitTemplate</span><span class="o">.</span><span class="na">convertAndSend</span><span class="o">(</span><span class="s">"object"</span><span class="o">,</span> <span class="n">user</span><span class="o">);</span>
<span class="o">}</span>

<span class="o">...</span>

<span class="c1">//æ¥æ”¶è€…</span>
<span class="nd">@RabbitHandler</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Receiver object : "</span> <span class="o">+</span> <span class="n">user</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ç»“æœå¦‚ä¸‹ï¼š</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sender object: User{name='neo', pass='123456'}
Receiver object : User{name='neo', pass='123456'}
</code></pre></div></div>

<p><strong>Topic Exchange</strong></p>

<p>topic æ˜¯ RabbitMQ ä¸­æœ€çµæ´»çš„ä¸€ç§æ–¹å¼ï¼Œå¯ä»¥æ ¹æ® routing_key è‡ªç”±çš„ç»‘å®šä¸åŒçš„é˜Ÿåˆ—</p>

<p>é¦–å…ˆå¯¹ topic è§„åˆ™é…ç½®ï¼Œè¿™é‡Œä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—æ¥æµ‹è¯•</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TopicRabbitConfig</span> <span class="o">{</span>

    <span class="kd">final</span> <span class="kd">static</span> <span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"topic.message"</span><span class="o">;</span>
    <span class="kd">final</span> <span class="kd">static</span> <span class="nc">String</span> <span class="n">messages</span> <span class="o">=</span> <span class="s">"topic.messages"</span><span class="o">;</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">Queue</span> <span class="nf">queueMessage</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Queue</span><span class="o">(</span><span class="nc">TopicRabbitConfig</span><span class="o">.</span><span class="na">message</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">Queue</span> <span class="nf">queueMessages</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Queue</span><span class="o">(</span><span class="nc">TopicRabbitConfig</span><span class="o">.</span><span class="na">messages</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="nc">TopicExchange</span> <span class="nf">exchange</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">TopicExchange</span><span class="o">(</span><span class="s">"exchange"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="nc">Binding</span> <span class="nf">bindingExchangeMessage</span><span class="o">(</span><span class="nc">Queue</span> <span class="n">queueMessage</span><span class="o">,</span> <span class="nc">TopicExchange</span> <span class="n">exchange</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">BindingBuilder</span><span class="o">.</span><span class="na">bind</span><span class="o">(</span><span class="n">queueMessage</span><span class="o">).</span><span class="na">to</span><span class="o">(</span><span class="n">exchange</span><span class="o">).</span><span class="na">with</span><span class="o">(</span><span class="s">"topic.message"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="nc">Binding</span> <span class="nf">bindingExchangeMessages</span><span class="o">(</span><span class="nc">Queue</span> <span class="n">queueMessages</span><span class="o">,</span> <span class="nc">TopicExchange</span> <span class="n">exchange</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">BindingBuilder</span><span class="o">.</span><span class="na">bind</span><span class="o">(</span><span class="n">queueMessages</span><span class="o">).</span><span class="na">to</span><span class="o">(</span><span class="n">exchange</span><span class="o">).</span><span class="na">with</span><span class="o">(</span><span class="s">"topic.#"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ä½¿ç”¨ queueMessages åŒæ—¶åŒ¹é…ä¸¤ä¸ªé˜Ÿåˆ—ï¼ŒqueueMessage åªåŒ¹é… â€œtopic.messageâ€ é˜Ÿåˆ—</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">send1</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">String</span> <span class="n">context</span> <span class="o">=</span> <span class="s">"hi, i am message 1"</span><span class="o">;</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Sender : "</span> <span class="o">+</span> <span class="n">context</span><span class="o">);</span>
	<span class="k">this</span><span class="o">.</span><span class="na">rabbitTemplate</span><span class="o">.</span><span class="na">convertAndSend</span><span class="o">(</span><span class="s">"exchange"</span><span class="o">,</span> <span class="s">"topic.message"</span><span class="o">,</span> <span class="n">context</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">send2</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">String</span> <span class="n">context</span> <span class="o">=</span> <span class="s">"hi, i am messages 2"</span><span class="o">;</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Sender : "</span> <span class="o">+</span> <span class="n">context</span><span class="o">);</span>
	<span class="k">this</span><span class="o">.</span><span class="na">rabbitTemplate</span><span class="o">.</span><span class="na">convertAndSend</span><span class="o">(</span><span class="s">"exchange"</span><span class="o">,</span> <span class="s">"topic.messages"</span><span class="o">,</span> <span class="n">context</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>å‘é€send1ä¼šåŒ¹é…åˆ°topic.#å’Œtopic.message ä¸¤ä¸ªReceiveréƒ½å¯ä»¥æ”¶åˆ°æ¶ˆæ¯ï¼Œå‘é€send2åªæœ‰topic.#å¯ä»¥åŒ¹é…æ‰€æœ‰åªæœ‰Receiver2ç›‘å¬åˆ°æ¶ˆæ¯</p>

<p><strong>Fanout Exchange</strong></p>

<p>Fanout å°±æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„å¹¿æ’­æ¨¡å¼æˆ–è€…è®¢é˜…æ¨¡å¼ï¼Œç»™ Fanout äº¤æ¢æœºå‘é€æ¶ˆæ¯ï¼Œç»‘å®šäº†è¿™ä¸ªäº¤æ¢æœºçš„æ‰€æœ‰é˜Ÿåˆ—éƒ½æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯ã€‚</p>

<p>Fanout ç›¸å…³é…ç½®</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FanoutRabbitConfig</span> <span class="o">{</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">Queue</span> <span class="nf">AMessage</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Queue</span><span class="o">(</span><span class="s">"fanout.A"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">Queue</span> <span class="nf">BMessage</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Queue</span><span class="o">(</span><span class="s">"fanout.B"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">Queue</span> <span class="nf">CMessage</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Queue</span><span class="o">(</span><span class="s">"fanout.C"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="nc">FanoutExchange</span> <span class="nf">fanoutExchange</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">FanoutExchange</span><span class="o">(</span><span class="s">"fanoutExchange"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="nc">Binding</span> <span class="nf">bindingExchangeA</span><span class="o">(</span><span class="nc">Queue</span> <span class="nc">AMessage</span><span class="o">,</span><span class="nc">FanoutExchange</span> <span class="n">fanoutExchange</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">BindingBuilder</span><span class="o">.</span><span class="na">bind</span><span class="o">(</span><span class="nc">AMessage</span><span class="o">).</span><span class="na">to</span><span class="o">(</span><span class="n">fanoutExchange</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="nc">Binding</span> <span class="nf">bindingExchangeB</span><span class="o">(</span><span class="nc">Queue</span> <span class="nc">BMessage</span><span class="o">,</span> <span class="nc">FanoutExchange</span> <span class="n">fanoutExchange</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">BindingBuilder</span><span class="o">.</span><span class="na">bind</span><span class="o">(</span><span class="nc">BMessage</span><span class="o">).</span><span class="na">to</span><span class="o">(</span><span class="n">fanoutExchange</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="nc">Binding</span> <span class="nf">bindingExchangeC</span><span class="o">(</span><span class="nc">Queue</span> <span class="nc">CMessage</span><span class="o">,</span> <span class="nc">FanoutExchange</span> <span class="n">fanoutExchange</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">BindingBuilder</span><span class="o">.</span><span class="na">bind</span><span class="o">(</span><span class="nc">CMessage</span><span class="o">).</span><span class="na">to</span><span class="o">(</span><span class="n">fanoutExchange</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>è¿™é‡Œä½¿ç”¨äº† Aã€Bã€C ä¸‰ä¸ªé˜Ÿåˆ—ç»‘å®šåˆ° Fanout äº¤æ¢æœºä¸Šé¢ï¼Œå‘é€ç«¯çš„ routing_key å†™ä»»ä½•å­—ç¬¦éƒ½ä¼šè¢«å¿½ç•¥ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">send</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">String</span> <span class="n">context</span> <span class="o">=</span> <span class="s">"hi, fanout msg "</span><span class="o">;</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Sender : "</span> <span class="o">+</span> <span class="n">context</span><span class="o">);</span>
	<span class="k">this</span><span class="o">.</span><span class="na">rabbitTemplate</span><span class="o">.</span><span class="na">convertAndSend</span><span class="o">(</span><span class="s">"fanoutExchange"</span><span class="o">,</span><span class="s">""</span><span class="o">,</span> <span class="n">context</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ç»“æœå¦‚ä¸‹ï¼š</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sender : hi, fanout msg 
...
fanout Receiver B: hi, fanout msg 
fanout Receiver A  : hi, fanout msg 
fanout Receiver C: hi, fanout msg 
</code></pre></div></div>

<p>ç»“æœè¯´æ˜ï¼Œç»‘å®šåˆ° fanout äº¤æ¢æœºä¸Šé¢çš„é˜Ÿåˆ—éƒ½æ”¶åˆ°äº†æ¶ˆæ¯</p>

<blockquote>
  <p>æ–‡ç« å†…å®¹å·²ç»å‡çº§åˆ° Spring Boot 2.x</p>
</blockquote>

<p><strong><a href="https://github.com/ityouknow/spring-boot-examples/tree/master/spring-boot-rabbitmq">ç¤ºä¾‹ä»£ç -github</a></strong></p>

<p><strong><a href="https://gitee.com/ityouknow/spring-boot-examples/tree/master/spring-boot-rabbitmq">ç¤ºä¾‹ä»£ç -ç äº‘</a></strong></p>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>

<p><a href="https://www.zouyesheng.com/rabbitmq.html">RabbitMQ ä½¿ç”¨å‚è€ƒ</a></p>

<p><a href="https://github.com/401Studio/WeekLearn/issues/2">RabbitMQï¼šSpring é›†æˆ RabbitMQ ä¸å…¶æ¦‚å¿µï¼Œæ¶ˆæ¯æŒä¹…åŒ–ï¼ŒACKæœºåˆ¶</a></p>
:ET