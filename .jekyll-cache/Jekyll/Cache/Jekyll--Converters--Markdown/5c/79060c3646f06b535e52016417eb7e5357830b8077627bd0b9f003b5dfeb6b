I"îÌ<p>è¿™ç¯‡æ–‡ç« æˆ‘ä»¬æ¥å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Spring Boot é›†æˆ Apache Shiro ã€‚å®‰å…¨åº”è¯¥æ˜¯äº’è”ç½‘å…¬å¸çš„ä¸€é“ç”Ÿå‘½çº¿ï¼Œå‡ ä¹ä»»ä½•çš„å…¬å¸éƒ½ä¼šæ¶‰åŠåˆ°è¿™æ–¹é¢çš„éœ€æ±‚ã€‚åœ¨ Java é¢†åŸŸä¸€èˆ¬æœ‰ Spring Securityã€ Apache Shiro ç­‰å®‰å…¨æ¡†æ¶ï¼Œä½†æ˜¯ç”±äº Spring Security è¿‡äºåºå¤§å’Œå¤æ‚ï¼Œå¤§å¤šæ•°å…¬å¸ä¼šé€‰æ‹© Apache Shiro æ¥ä½¿ç”¨ï¼Œè¿™ç¯‡æ–‡ç« ä¼šå…ˆä»‹ç»ä¸€ä¸‹ Apache Shiro ï¼Œåœ¨ç»“åˆ Spring Boot ç»™å‡ºä½¿ç”¨æ¡ˆä¾‹ã€‚</p>

<h2 id="apache-shiro">Apache Shiro</h2>

<h3 id="what-is-apache-shiro">What is Apache Shiro?</h3>

<p>Apache Shiro æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ã€çµæ´»çš„ï¼Œå¼€æºçš„å®‰å…¨æ¡†æ¶ã€‚å®ƒå¯ä»¥å¹²å‡€åˆ©è½åœ°å¤„ç†èº«ä»½éªŒè¯ã€æˆæƒã€ä¼ä¸šä¼šè¯ç®¡ç†å’ŒåŠ å¯†ã€‚</p>

<p>Apache Shiro çš„é¦–è¦ç›®æ ‡æ˜¯æ˜“äºä½¿ç”¨å’Œç†è§£ã€‚å®‰å…¨é€šå¸¸å¾ˆå¤æ‚ï¼Œç”šè‡³è®©äººæ„Ÿåˆ°å¾ˆç—›è‹¦ï¼Œä½†æ˜¯ Shiro å´ä¸æ˜¯è¿™æ ·å­çš„ã€‚ä¸€ä¸ªå¥½çš„å®‰å…¨æ¡†æ¶åº”è¯¥å±è”½å¤æ‚æ€§ï¼Œå‘å¤–æš´éœ²ç®€å•ã€ç›´è§‚çš„ APIï¼Œæ¥ç®€åŒ–å¼€å‘äººå‘˜å®ç°åº”ç”¨ç¨‹åºå®‰å…¨æ‰€èŠ±è´¹çš„æ—¶é—´å’Œç²¾åŠ›ã€‚</p>

<p>Shiro èƒ½åšä»€ä¹ˆå‘¢ï¼Ÿ</p>

<ul>
  <li>éªŒè¯ç”¨æˆ·èº«ä»½</li>
  <li>ç”¨æˆ·è®¿é—®æƒé™æ§åˆ¶ï¼Œæ¯”å¦‚ï¼š1ã€åˆ¤æ–­ç”¨æˆ·æ˜¯å¦åˆ†é…äº†ä¸€å®šçš„å®‰å…¨è§’è‰²ã€‚2ã€åˆ¤æ–­ç”¨æˆ·æ˜¯å¦è¢«æˆäºˆå®ŒæˆæŸä¸ªæ“ä½œçš„æƒé™</li>
  <li>åœ¨é Web æˆ– EJB å®¹å™¨çš„ç¯å¢ƒä¸‹å¯ä»¥ä»»æ„ä½¿ç”¨ Session API</li>
  <li>å¯ä»¥å“åº”è®¤è¯ã€è®¿é—®æ§åˆ¶ï¼Œæˆ–è€… Session ç”Ÿå‘½å‘¨æœŸä¸­å‘ç”Ÿçš„äº‹ä»¶</li>
  <li>å¯å°†ä¸€ä¸ªæˆ–ä»¥ä¸Šç”¨æˆ·å®‰å…¨æ•°æ®æºæ•°æ®ç»„åˆæˆä¸€ä¸ªå¤åˆçš„ç”¨æˆ· â€œviewâ€(è§†å›¾)</li>
  <li>æ”¯æŒå•ç‚¹ç™»å½•(SSO)åŠŸèƒ½</li>
  <li>æ”¯æŒæä¾›â€œRemember Meâ€æœåŠ¡ï¼Œè·å–ç”¨æˆ·å…³è”ä¿¡æ¯è€Œæ— éœ€ç™»å½•<br />
â€¦</li>
</ul>

<p>ç­‰ç­‰â€”â€”éƒ½é›†æˆåˆ°ä¸€ä¸ªæœ‰å‡èšåŠ›çš„æ˜“äºä½¿ç”¨çš„ APIã€‚</p>

<p>Shiro è‡´åŠ›åœ¨æ‰€æœ‰åº”ç”¨ç¯å¢ƒä¸‹å®ç°ä¸Šè¿°åŠŸèƒ½ï¼Œå°åˆ°å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºï¼Œå¤§åˆ°ä¼ä¸šåº”ç”¨ä¸­ï¼Œè€Œä¸”ä¸éœ€è¦å€ŸåŠ©ç¬¬ä¸‰æ–¹æ¡†æ¶ã€å®¹å™¨ã€åº”ç”¨æœåŠ¡å™¨ç­‰ã€‚å½“ç„¶ Shiro çš„ç›®çš„æ˜¯å°½é‡çš„èå…¥åˆ°è¿™æ ·çš„åº”ç”¨ç¯å¢ƒä¸­å»ï¼Œä½†ä¹Ÿå¯ä»¥åœ¨å®ƒä»¬ä¹‹å¤–çš„ä»»ä½•ç¯å¢ƒä¸‹å¼€ç®±å³ç”¨ã€‚</p>

<h3 id="apache-shiro-features-ç‰¹æ€§">Apache Shiro Features ç‰¹æ€§</h3>

<p>Apache Shiro æ˜¯ä¸€ä¸ªå…¨é¢çš„ã€è•´å«ä¸°å¯ŒåŠŸèƒ½çš„å®‰å…¨æ¡†æ¶ã€‚ä¸‹å›¾ä¸ºæè¿° Shiro åŠŸèƒ½çš„æ¡†æ¶å›¾ï¼š</p>

<p><img src="http://favorites.ren/assets/images/2017/springboot/ShiroFeatures.png" alt="" /></p>

<p>Authenticationï¼ˆè®¤è¯ï¼‰, Authorizationï¼ˆæˆæƒï¼‰, Session Managementï¼ˆä¼šè¯ç®¡ç†ï¼‰, Cryptographyï¼ˆåŠ å¯†ï¼‰è¢« Shiro æ¡†æ¶çš„å¼€å‘å›¢é˜Ÿç§°ä¹‹ä¸ºåº”ç”¨å®‰å…¨çš„å››å¤§åŸºçŸ³ã€‚é‚£ä¹ˆå°±è®©æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒä»¬å§ï¼š</p>

<ul>
  <li><strong>Authenticationï¼ˆè®¤è¯ï¼‰ï¼š</strong>ç”¨æˆ·èº«ä»½è¯†åˆ«ï¼Œé€šå¸¸è¢«ç§°ä¸ºç”¨æˆ·â€œç™»å½•â€</li>
  <li><strong>Authorizationï¼ˆæˆæƒï¼‰ï¼š</strong>è®¿é—®æ§åˆ¶ã€‚æ¯”å¦‚æŸä¸ªç”¨æˆ·æ˜¯å¦å…·æœ‰æŸä¸ªæ“ä½œçš„ä½¿ç”¨æƒé™ã€‚</li>
  <li><strong>Session Managementï¼ˆä¼šè¯ç®¡ç†ï¼‰ï¼š</strong>ç‰¹å®šäºç”¨æˆ·çš„ä¼šè¯ç®¡ç†,ç”šè‡³åœ¨éweb æˆ– EJB åº”ç”¨ç¨‹åºã€‚</li>
  <li><strong>Cryptographyï¼ˆåŠ å¯†ï¼‰ï¼š</strong>åœ¨å¯¹æ•°æ®æºä½¿ç”¨åŠ å¯†ç®—æ³•åŠ å¯†çš„åŒæ—¶ï¼Œä¿è¯æ˜“äºä½¿ç”¨ã€‚</li>
</ul>

<p>è¿˜æœ‰å…¶ä»–çš„åŠŸèƒ½æ¥æ”¯æŒå’ŒåŠ å¼ºè¿™äº›ä¸åŒåº”ç”¨ç¯å¢ƒä¸‹å®‰å…¨é¢†åŸŸçš„å…³æ³¨ç‚¹ã€‚ç‰¹åˆ«æ˜¯å¯¹ä»¥ä¸‹çš„åŠŸèƒ½æ”¯æŒï¼š</p>

<ul>
  <li>Webæ”¯æŒï¼šShiro æä¾›çš„ Web æ”¯æŒ api ï¼Œå¯ä»¥å¾ˆè½»æ¾çš„ä¿æŠ¤ Web åº”ç”¨ç¨‹åºçš„å®‰å…¨ã€‚</li>
  <li>ç¼“å­˜ï¼šç¼“å­˜æ˜¯ Apache Shiro ä¿è¯å®‰å…¨æ“ä½œå¿«é€Ÿã€é«˜æ•ˆçš„é‡è¦æ‰‹æ®µã€‚</li>
  <li>å¹¶å‘ï¼šApache Shiro æ”¯æŒå¤šçº¿ç¨‹åº”ç”¨ç¨‹åºçš„å¹¶å‘ç‰¹æ€§ã€‚</li>
  <li>æµ‹è¯•ï¼šæ”¯æŒå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ï¼Œç¡®ä¿ä»£ç å’Œé¢„æƒ³çš„ä¸€æ ·å®‰å…¨ã€‚</li>
  <li>â€œRun Asâ€ï¼šè¿™ä¸ªåŠŸèƒ½å…è®¸ç”¨æˆ·å‡è®¾å¦ä¸€ä¸ªç”¨æˆ·çš„èº«ä»½(åœ¨è®¸å¯çš„å‰æä¸‹)ã€‚</li>
  <li>â€œRemember Meâ€ï¼šè·¨ session è®°å½•ç”¨æˆ·çš„èº«ä»½ï¼Œåªæœ‰åœ¨å¼ºåˆ¶éœ€è¦æ—¶æ‰éœ€è¦ç™»å½•ã€‚</li>
</ul>

<blockquote>
  <p>æ³¨æ„ï¼š Shiro ä¸ä¼šå»ç»´æŠ¤ç”¨æˆ·ã€ç»´æŠ¤æƒé™ï¼Œè¿™äº›éœ€è¦æˆ‘ä»¬è‡ªå·±å»è®¾è®¡/æä¾›ï¼Œç„¶åé€šè¿‡ç›¸åº”çš„æ¥å£æ³¨å…¥ç»™ Shiro</p>
</blockquote>

<h3 id="high-level-overview-é«˜çº§æ¦‚è¿°">High-Level Overview é«˜çº§æ¦‚è¿°</h3>

<p>åœ¨æ¦‚å¿µå±‚ï¼ŒShiro æ¶æ„åŒ…å«ä¸‰ä¸ªä¸»è¦çš„ç†å¿µï¼šSubjectï¼ŒSecurityManagerå’Œ Realmã€‚ä¸‹é¢çš„å›¾å±•ç¤ºäº†è¿™äº›ç»„ä»¶å¦‚ä½•ç›¸äº’ä½œç”¨ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢ä¾æ¬¡å¯¹å…¶è¿›è¡Œæè¿°ã€‚</p>

<p><img src="http://favorites.ren/assets/images/2017/springboot/ShiroBasicArchitecture.png" alt="" /></p>

<ul>
  <li>Subjectï¼šå½“å‰ç”¨æˆ·ï¼ŒSubject å¯ä»¥æ˜¯ä¸€ä¸ªäººï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯ç¬¬ä¸‰æ–¹æœåŠ¡ã€å®ˆæŠ¤è¿›ç¨‹å¸æˆ·ã€æ—¶é’Ÿå®ˆæŠ¤ä»»åŠ¡æˆ–è€…å…¶å®ƒâ€“å½“å‰å’Œè½¯ä»¶äº¤äº’çš„ä»»ä½•äº‹ä»¶ã€‚</li>
  <li>SecurityManagerï¼šç®¡ç†æ‰€æœ‰Subjectï¼ŒSecurityManager æ˜¯ Shiro æ¶æ„çš„æ ¸å¿ƒï¼Œé…åˆå†…éƒ¨å®‰å…¨ç»„ä»¶å…±åŒç»„æˆå®‰å…¨ä¼ã€‚</li>
  <li>Realmsï¼šç”¨äºè¿›è¡Œæƒé™ä¿¡æ¯çš„éªŒè¯ï¼Œæˆ‘ä»¬è‡ªå·±å®ç°ã€‚Realm æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç‰¹å®šçš„å®‰å…¨ DAOï¼šå®ƒå°è£…ä¸æ•°æ®æºè¿æ¥çš„ç»†èŠ‚ï¼Œå¾—åˆ°Shiro æ‰€éœ€çš„ç›¸å…³çš„æ•°æ®ã€‚åœ¨é…ç½® Shiro çš„æ—¶å€™ï¼Œä½ å¿…é¡»æŒ‡å®šè‡³å°‘ä¸€ä¸ªRealm æ¥å®ç°è®¤è¯ï¼ˆauthenticationï¼‰å’Œ/æˆ–æˆæƒï¼ˆauthorizationï¼‰ã€‚</li>
</ul>

<p>æˆ‘ä»¬éœ€è¦å®ç°Realmsçš„Authentication å’Œ Authorizationã€‚å…¶ä¸­ Authentication æ˜¯ç”¨æ¥éªŒè¯ç”¨æˆ·èº«ä»½ï¼ŒAuthorization æ˜¯æˆæƒè®¿é—®æ§åˆ¶ï¼Œç”¨äºå¯¹ç”¨æˆ·è¿›è¡Œçš„æ“ä½œæˆæƒï¼Œè¯æ˜è¯¥ç”¨æˆ·æ˜¯å¦å…è®¸è¿›è¡Œå½“å‰æ“ä½œï¼Œå¦‚è®¿é—®æŸä¸ªé“¾æ¥ï¼ŒæŸä¸ªèµ„æºæ–‡ä»¶ç­‰ã€‚</p>

<h2 id="å¿«é€Ÿä¸Šæ‰‹">å¿«é€Ÿä¸Šæ‰‹</h2>

<h3 id="åŸºç¡€ä¿¡æ¯">åŸºç¡€ä¿¡æ¯</h3>

<p><strong>pomåŒ…ä¾èµ–</strong></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependencies&gt;</span>
	<span class="nt">&lt;dependency&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-data-jpa<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;/dependency&gt;</span>
	<span class="nt">&lt;dependency&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-thymeleaf<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;/dependency&gt;</span>
	<span class="nt">&lt;dependency&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>net.sourceforge.nekohtml<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>nekohtml<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>1.9.22<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;/dependency&gt;</span>
	<span class="nt">&lt;dependency&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;/dependency&gt;</span>
	<span class="nt">&lt;dependency&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>org.apache.shiro<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>shiro-spring<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>1.4.0<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;/dependency&gt;</span>
	<span class="nt">&lt;dependency&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;scope&gt;</span>runtime<span class="nt">&lt;/scope&gt;</span>
	<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
</code></pre></div></div>

<p>é‡ç‚¹æ˜¯ shiro-spring åŒ…</p>

<p><strong>é…ç½®æ–‡ä»¶</strong></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spring:
    datasource:
      url: jdbc:mysql://localhost:3306/test
      username: root
      password: root
      driver-class-name: com.mysql.jdbc.Driver

    jpa:
      database: mysql
      show-sql: true
      hibernate:
        ddl-auto: update
        naming:
          strategy: org.hibernate.cfg.DefaultComponentSafeNamingStrategy
      properties:
         hibernate:
            dialect: org.hibernate.dialect.MySQL5Dialect

    thymeleaf:
       cache: false
       mode: LEGACYHTML5
</code></pre></div></div>

<p>thymeleafçš„é…ç½®æ˜¯ä¸ºäº†å»æ‰htmlçš„æ ¡éªŒ</p>

<p><strong>é¡µé¢</strong></p>

<p>æˆ‘ä»¬æ–°å»ºäº†å…­ä¸ªé¡µé¢ç”¨æ¥æµ‹è¯•ï¼š</p>

<ul>
  <li>index.html ï¼šé¦–é¡µ</li>
  <li>login.html  ï¼šç™»å½•é¡µ</li>
  <li>userInfo.html ï¼š ç”¨æˆ·ä¿¡æ¯é¡µé¢</li>
  <li>userInfoAdd.html ï¼šæ·»åŠ ç”¨æˆ·é¡µé¢</li>
  <li>userInfoDel.html ï¼šåˆ é™¤ç”¨æˆ·é¡µé¢</li>
  <li>403.html ï¼š æ²¡æœ‰æƒé™çš„é¡µé¢</li>
</ul>

<p>é™¤è¿‡ç™»å½•é¡µé¢å…¶å®ƒéƒ½å¾ˆç®€å•ï¼Œå¤§æ¦‚å¦‚ä¸‹ï¼š</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Title<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;h1&gt;</span>index<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<h3 id="rbac">RBAC</h3>

<p>RBAC æ˜¯åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRole-Based Access Control ï¼‰åœ¨ RBAC ä¸­ï¼Œæƒé™ä¸è§’è‰²ç›¸å…³è”ï¼Œç”¨æˆ·é€šè¿‡æˆä¸ºé€‚å½“è§’è‰²çš„æˆå‘˜è€Œå¾—åˆ°è¿™äº›è§’è‰²çš„æƒé™ã€‚è¿™å°±æå¤§åœ°ç®€åŒ–äº†æƒé™çš„ç®¡ç†ã€‚è¿™æ ·ç®¡ç†éƒ½æ˜¯å±‚çº§ç›¸äº’ä¾èµ–çš„ï¼Œæƒé™èµ‹äºˆç»™è§’è‰²ï¼Œè€ŒæŠŠè§’è‰²åˆèµ‹äºˆç”¨æˆ·ï¼Œè¿™æ ·çš„æƒé™è®¾è®¡å¾ˆæ¸…æ¥šï¼Œç®¡ç†èµ·æ¥å¾ˆæ–¹ä¾¿ã€‚</p>

<p>é‡‡ç”¨ Jpa æŠ€æœ¯æ¥è‡ªåŠ¨ç”ŸæˆåŸºç¡€è¡¨æ ¼ï¼Œå¯¹åº”çš„å®ä½“å¦‚ä¸‹ï¼š</p>

<p>ç”¨æˆ·ä¿¡æ¯</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserInfo</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span>
    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">uid</span><span class="o">;</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">unique</span> <span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span><span class="c1">//å¸å·</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span><span class="c1">//åç§°ï¼ˆæ˜µç§°æˆ–è€…çœŸå®å§“åï¼Œä¸åŒç³»ç»Ÿä¸åŒå®šä¹‰ï¼‰</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span> <span class="c1">//å¯†ç ;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">salt</span><span class="o">;</span><span class="c1">//åŠ å¯†å¯†ç çš„ç›</span>
    <span class="kd">private</span> <span class="kt">byte</span> <span class="n">state</span><span class="o">;</span><span class="c1">//ç”¨æˆ·çŠ¶æ€,0:åˆ›å»ºæœªè®¤è¯ï¼ˆæ¯”å¦‚æ²¡æœ‰æ¿€æ´»ï¼Œæ²¡æœ‰è¾“å…¥éªŒè¯ç ç­‰ç­‰ï¼‰--ç­‰å¾…éªŒè¯çš„ç”¨æˆ· , 1:æ­£å¸¸çŠ¶æ€,2ï¼šç”¨æˆ·è¢«é”å®š.</span>
    <span class="nd">@ManyToMany</span><span class="o">(</span><span class="n">fetch</span><span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">EAGER</span><span class="o">)</span><span class="c1">//ç«‹å³ä»æ•°æ®åº“ä¸­è¿›è¡ŒåŠ è½½æ•°æ®;</span>
    <span class="nd">@JoinTable</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"SysUserRole"</span><span class="o">,</span> <span class="n">joinColumns</span> <span class="o">=</span> <span class="o">{</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"uid"</span><span class="o">)</span> <span class="o">},</span> <span class="n">inverseJoinColumns</span> <span class="o">={</span><span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"roleId"</span><span class="o">)</span> <span class="o">})</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">SysRole</span><span class="o">&gt;</span> <span class="n">roleList</span><span class="o">;</span><span class="c1">// ä¸€ä¸ªç”¨æˆ·å…·æœ‰å¤šä¸ªè§’è‰²</span>

    <span class="c1">// çœç•¥ get set æ–¹æ³•</span>
 <span class="o">}</span>
</code></pre></div></div>

<p>è§’è‰²ä¿¡æ¯</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SysRole</span> <span class="o">{</span>
    <span class="nd">@Id@GeneratedValue</span>
    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">id</span><span class="o">;</span> <span class="c1">// ç¼–å·</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">role</span><span class="o">;</span> <span class="c1">// è§’è‰²æ ‡è¯†ç¨‹åºä¸­åˆ¤æ–­ä½¿ç”¨,å¦‚"admin",è¿™ä¸ªæ˜¯å”¯ä¸€çš„:</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">description</span><span class="o">;</span> <span class="c1">// è§’è‰²æè¿°,UIç•Œé¢æ˜¾ç¤ºä½¿ç”¨</span>
    <span class="kd">private</span> <span class="nc">Boolean</span> <span class="n">available</span> <span class="o">=</span> <span class="nc">Boolean</span><span class="o">.</span><span class="na">FALSE</span><span class="o">;</span> <span class="c1">// æ˜¯å¦å¯ç”¨,å¦‚æœä¸å¯ç”¨å°†ä¸ä¼šæ·»åŠ ç»™ç”¨æˆ·</span>

    <span class="c1">//è§’è‰² -- æƒé™å…³ç³»ï¼šå¤šå¯¹å¤šå…³ç³»;</span>
    <span class="nd">@ManyToMany</span><span class="o">(</span><span class="n">fetch</span><span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">EAGER</span><span class="o">)</span>
    <span class="nd">@JoinTable</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"SysRolePermission"</span><span class="o">,</span><span class="n">joinColumns</span><span class="o">={</span><span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"roleId"</span><span class="o">)},</span><span class="n">inverseJoinColumns</span><span class="o">={</span><span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"permissionId"</span><span class="o">)})</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">SysPermission</span><span class="o">&gt;</span> <span class="n">permissions</span><span class="o">;</span>

    <span class="c1">// ç”¨æˆ· - è§’è‰²å…³ç³»å®šä¹‰;</span>
    <span class="nd">@ManyToMany</span>
    <span class="nd">@JoinTable</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"SysUserRole"</span><span class="o">,</span><span class="n">joinColumns</span><span class="o">={</span><span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"roleId"</span><span class="o">)},</span><span class="n">inverseJoinColumns</span><span class="o">={</span><span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"uid"</span><span class="o">)})</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">UserInfo</span><span class="o">&gt;</span> <span class="n">userInfos</span><span class="o">;</span><span class="c1">// ä¸€ä¸ªè§’è‰²å¯¹åº”å¤šä¸ªç”¨æˆ·</span>

    <span class="c1">// çœç•¥ get set æ–¹æ³•</span>
 <span class="o">}</span>
</code></pre></div></div>

<p>æƒé™ä¿¡æ¯</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SysPermission</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>
    <span class="nd">@Id@GeneratedValue</span>
    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">id</span><span class="o">;</span><span class="c1">//ä¸»é”®.</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span><span class="c1">//åç§°.</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">columnDefinition</span><span class="o">=</span><span class="s">"enum('menu','button')"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">resourceType</span><span class="o">;</span><span class="c1">//èµ„æºç±»å‹ï¼Œ[menu|button]</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">url</span><span class="o">;</span><span class="c1">//èµ„æºè·¯å¾„.</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">permission</span><span class="o">;</span> <span class="c1">//æƒé™å­—ç¬¦ä¸²,menuä¾‹å­ï¼šrole:*ï¼Œbuttonä¾‹å­ï¼šrole:create,role:update,role:delete,role:view</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">parentId</span><span class="o">;</span> <span class="c1">//çˆ¶ç¼–å·</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">parentIds</span><span class="o">;</span> <span class="c1">//çˆ¶ç¼–å·åˆ—è¡¨</span>
    <span class="kd">private</span> <span class="nc">Boolean</span> <span class="n">available</span> <span class="o">=</span> <span class="nc">Boolean</span><span class="o">.</span><span class="na">FALSE</span><span class="o">;</span>
    <span class="nd">@ManyToMany</span>
    <span class="nd">@JoinTable</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"SysRolePermission"</span><span class="o">,</span><span class="n">joinColumns</span><span class="o">={</span><span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"permissionId"</span><span class="o">)},</span><span class="n">inverseJoinColumns</span><span class="o">={</span><span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"roleId"</span><span class="o">)})</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">SysRole</span><span class="o">&gt;</span> <span class="n">roles</span><span class="o">;</span>

    <span class="c1">// çœç•¥ get set æ–¹æ³•</span>
 <span class="o">}</span>
</code></pre></div></div>

<p>æ ¹æ®ä»¥ä¸Šçš„ä»£ç ä¼šè‡ªåŠ¨ç”Ÿæˆ user_infoï¼ˆç”¨æˆ·ä¿¡æ¯è¡¨ï¼‰ã€sys_roleï¼ˆè§’è‰²è¡¨ï¼‰ã€sys_permissionï¼ˆæƒé™è¡¨ï¼‰ã€sys_user_roleï¼ˆç”¨æˆ·è§’è‰²è¡¨ï¼‰ã€sys_role_permissionï¼ˆè§’è‰²æƒé™è¡¨ï¼‰è¿™äº”å¼ è¡¨ï¼Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•æˆ‘ä»¬ç»™è¿™äº”å¼ è¡¨æ’å…¥ä¸€äº›åˆå§‹åŒ–æ•°æ®ï¼š</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`user_info`</span> <span class="p">(</span><span class="nv">`uid`</span><span class="p">,</span><span class="nv">`username`</span><span class="p">,</span><span class="nv">`name`</span><span class="p">,</span><span class="nv">`password`</span><span class="p">,</span><span class="nv">`salt`</span><span class="p">,</span><span class="nv">`state`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'1'</span><span class="p">,</span> <span class="s1">'admin'</span><span class="p">,</span> <span class="s1">'ç®¡ç†å‘˜'</span><span class="p">,</span> <span class="s1">'d3c59d25033dbf980d29554025c23a75'</span><span class="p">,</span> <span class="s1">'8d78869f470951332959580424d4bf4f'</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`sys_permission`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span><span class="nv">`available`</span><span class="p">,</span><span class="nv">`name`</span><span class="p">,</span><span class="nv">`parent_id`</span><span class="p">,</span><span class="nv">`parent_ids`</span><span class="p">,</span><span class="nv">`permission`</span><span class="p">,</span><span class="nv">`resource_type`</span><span class="p">,</span><span class="nv">`url`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">'ç”¨æˆ·ç®¡ç†'</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">'0/'</span><span class="p">,</span><span class="s1">'userInfo:view'</span><span class="p">,</span><span class="s1">'menu'</span><span class="p">,</span><span class="s1">'userInfo/userList'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`sys_permission`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span><span class="nv">`available`</span><span class="p">,</span><span class="nv">`name`</span><span class="p">,</span><span class="nv">`parent_id`</span><span class="p">,</span><span class="nv">`parent_ids`</span><span class="p">,</span><span class="nv">`permission`</span><span class="p">,</span><span class="nv">`resource_type`</span><span class="p">,</span><span class="nv">`url`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">'ç”¨æˆ·æ·»åŠ '</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">'0/1'</span><span class="p">,</span><span class="s1">'userInfo:add'</span><span class="p">,</span><span class="s1">'button'</span><span class="p">,</span><span class="s1">'userInfo/userAdd'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`sys_permission`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span><span class="nv">`available`</span><span class="p">,</span><span class="nv">`name`</span><span class="p">,</span><span class="nv">`parent_id`</span><span class="p">,</span><span class="nv">`parent_ids`</span><span class="p">,</span><span class="nv">`permission`</span><span class="p">,</span><span class="nv">`resource_type`</span><span class="p">,</span><span class="nv">`url`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">'ç”¨æˆ·åˆ é™¤'</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">'0/1'</span><span class="p">,</span><span class="s1">'userInfo:del'</span><span class="p">,</span><span class="s1">'button'</span><span class="p">,</span><span class="s1">'userInfo/userDel'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`sys_role`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span><span class="nv">`available`</span><span class="p">,</span><span class="nv">`description`</span><span class="p">,</span><span class="nv">`role`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">'ç®¡ç†å‘˜'</span><span class="p">,</span><span class="s1">'admin'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`sys_role`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span><span class="nv">`available`</span><span class="p">,</span><span class="nv">`description`</span><span class="p">,</span><span class="nv">`role`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">'VIPä¼šå‘˜'</span><span class="p">,</span><span class="s1">'vip'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`sys_role`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span><span class="nv">`available`</span><span class="p">,</span><span class="nv">`description`</span><span class="p">,</span><span class="nv">`role`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">'test'</span><span class="p">,</span><span class="s1">'test'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`sys_role_permission`</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'1'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`sys_role_permission`</span> <span class="p">(</span><span class="nv">`permission_id`</span><span class="p">,</span><span class="nv">`role_id`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`sys_role_permission`</span> <span class="p">(</span><span class="nv">`permission_id`</span><span class="p">,</span><span class="nv">`role_id`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`sys_role_permission`</span> <span class="p">(</span><span class="nv">`permission_id`</span><span class="p">,</span><span class="nv">`role_id`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`sys_user_role`</span> <span class="p">(</span><span class="nv">`role_id`</span><span class="p">,</span><span class="nv">`uid`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="shiro-é…ç½®">Shiro é…ç½®</h3>

<p>é¦–å…ˆè¦é…ç½®çš„æ˜¯ ShiroConfig ç±»ï¼ŒApache Shiro æ ¸å¿ƒé€šè¿‡ Filter æ¥å®ç°ï¼Œå°±å¥½åƒ SpringMvc é€šè¿‡ DispachServlet æ¥ä¸»æ§åˆ¶ä¸€æ ·ã€‚
æ—¢ç„¶æ˜¯ä½¿ç”¨ Filter ä¸€èˆ¬ä¹Ÿå°±èƒ½çŒœåˆ°ï¼Œæ˜¯é€šè¿‡ URL è§„åˆ™æ¥è¿›è¡Œè¿‡æ»¤å’Œæƒé™æ ¡éªŒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ç³»åˆ—å…³äº URL çš„è§„åˆ™å’Œè®¿é—®æƒé™ã€‚</p>

<p><strong>ShiroConfig</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ShiroConfig</span> <span class="o">{</span>
	<span class="nd">@Bean</span>
	<span class="kd">public</span> <span class="nc">ShiroFilterFactoryBean</span> <span class="nf">shirFilter</span><span class="o">(</span><span class="nc">SecurityManager</span> <span class="n">securityManager</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"ShiroConfiguration.shirFilter()"</span><span class="o">);</span>
		<span class="nc">ShiroFilterFactoryBean</span> <span class="n">shiroFilterFactoryBean</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ShiroFilterFactoryBean</span><span class="o">();</span>
		<span class="n">shiroFilterFactoryBean</span><span class="o">.</span><span class="na">setSecurityManager</span><span class="o">(</span><span class="n">securityManager</span><span class="o">);</span>
		<span class="c1">//æ‹¦æˆªå™¨.</span>
		<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">filterChainDefinitionMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedHashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;();</span>
		<span class="c1">// é…ç½®ä¸ä¼šè¢«æ‹¦æˆªçš„é“¾æ¥ é¡ºåºåˆ¤æ–­</span>
		<span class="n">filterChainDefinitionMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"/static/**"</span><span class="o">,</span> <span class="s">"anon"</span><span class="o">);</span>
		<span class="c1">//é…ç½®é€€å‡º è¿‡æ»¤å™¨,å…¶ä¸­çš„å…·ä½“çš„é€€å‡ºä»£ç Shiroå·²ç»æ›¿æˆ‘ä»¬å®ç°äº†</span>
		<span class="n">filterChainDefinitionMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"/logout"</span><span class="o">,</span> <span class="s">"logout"</span><span class="o">);</span>
		<span class="c1">//&lt;!-- è¿‡æ»¤é“¾å®šä¹‰ï¼Œä»ä¸Šå‘ä¸‹é¡ºåºæ‰§è¡Œï¼Œä¸€èˆ¬å°†/**æ”¾åœ¨æœ€ä¸ºä¸‹è¾¹ --&gt;:è¿™æ˜¯ä¸€ä¸ªå‘å‘¢ï¼Œä¸€ä¸å°å¿ƒä»£ç å°±ä¸å¥½ä½¿äº†;</span>
		<span class="c1">//&lt;!-- authc:æ‰€æœ‰urléƒ½å¿…é¡»è®¤è¯é€šè¿‡æ‰å¯ä»¥è®¿é—®; anon:æ‰€æœ‰urléƒ½éƒ½å¯ä»¥åŒ¿åè®¿é—®--&gt;</span>
		<span class="n">filterChainDefinitionMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"/**"</span><span class="o">,</span> <span class="s">"authc"</span><span class="o">);</span>
		<span class="c1">// å¦‚æœä¸è®¾ç½®é»˜è®¤ä¼šè‡ªåŠ¨å¯»æ‰¾Webå·¥ç¨‹æ ¹ç›®å½•ä¸‹çš„"/login.jsp"é¡µé¢</span>
		<span class="n">shiroFilterFactoryBean</span><span class="o">.</span><span class="na">setLoginUrl</span><span class="o">(</span><span class="s">"/login"</span><span class="o">);</span>
		<span class="c1">// ç™»å½•æˆåŠŸåè¦è·³è½¬çš„é“¾æ¥</span>
		<span class="n">shiroFilterFactoryBean</span><span class="o">.</span><span class="na">setSuccessUrl</span><span class="o">(</span><span class="s">"/index"</span><span class="o">);</span>

		<span class="c1">//æœªæˆæƒç•Œé¢;</span>
		<span class="n">shiroFilterFactoryBean</span><span class="o">.</span><span class="na">setUnauthorizedUrl</span><span class="o">(</span><span class="s">"/403"</span><span class="o">);</span>
		<span class="n">shiroFilterFactoryBean</span><span class="o">.</span><span class="na">setFilterChainDefinitionMap</span><span class="o">(</span><span class="n">filterChainDefinitionMap</span><span class="o">);</span>
		<span class="k">return</span> <span class="n">shiroFilterFactoryBean</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="nd">@Bean</span>
	<span class="kd">public</span> <span class="nc">MyShiroRealm</span> <span class="nf">myShiroRealm</span><span class="o">(){</span>
		<span class="nc">MyShiroRealm</span> <span class="n">myShiroRealm</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyShiroRealm</span><span class="o">();</span>
		<span class="k">return</span> <span class="n">myShiroRealm</span><span class="o">;</span>
	<span class="o">}</span>


	<span class="nd">@Bean</span>
	<span class="kd">public</span> <span class="nc">SecurityManager</span> <span class="nf">securityManager</span><span class="o">(){</span>
		<span class="nc">DefaultWebSecurityManager</span> <span class="n">securityManager</span> <span class="o">=</span>  <span class="k">new</span> <span class="nc">DefaultWebSecurityManager</span><span class="o">();</span>
		<span class="n">securityManager</span><span class="o">.</span><span class="na">setRealm</span><span class="o">(</span><span class="n">myShiroRealm</span><span class="o">());</span>
		<span class="k">return</span> <span class="n">securityManager</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Filter Chain å®šä¹‰è¯´æ˜ï¼š</p>

<ul>
  <li>1ã€ä¸€ä¸ªURLå¯ä»¥é…ç½®å¤šä¸ª Filterï¼Œä½¿ç”¨é€—å·åˆ†éš”</li>
  <li>2ã€å½“è®¾ç½®å¤šä¸ªè¿‡æ»¤å™¨æ—¶ï¼Œå…¨éƒ¨éªŒè¯é€šè¿‡ï¼Œæ‰è§†ä¸ºé€šè¿‡</li>
  <li>3ã€éƒ¨åˆ†è¿‡æ»¤å™¨å¯æŒ‡å®šå‚æ•°ï¼Œå¦‚ permsï¼Œroles</li>
</ul>

<p>Shiro å†…ç½®çš„ FilterChain</p>

<table>
  <thead>
    <tr>
      <th>Filter Name</th>
      <th>Class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>anon</td>
      <td>org.apache.shiro.web.filter.authc.AnonymousFilter</td>
    </tr>
    <tr>
      <td>authc</td>
      <td>org.apache.shiro.web.filter.authc.FormAuthenticationFilter</td>
    </tr>
    <tr>
      <td>authcBasic</td>
      <td>org.apache.shiro.web.filter.authc.BasicHttpAuthenticationFilter</td>
    </tr>
    <tr>
      <td>perms</td>
      <td>org.apache.shiro.web.filter.authz.PermissionsAuthorizationFilter</td>
    </tr>
    <tr>
      <td>port</td>
      <td>org.apache.shiro.web.filter.authz.PortFilter</td>
    </tr>
    <tr>
      <td>rest</td>
      <td>org.apache.shiro.web.filter.authz.HttpMethodPermissionFilter</td>
    </tr>
    <tr>
      <td>roles</td>
      <td>org.apache.shiro.web.filter.authz.RolesAuthorizationFilter</td>
    </tr>
    <tr>
      <td>ssl</td>
      <td>org.apache.shiro.web.filter.authz.SslFilter</td>
    </tr>
    <tr>
      <td>user</td>
      <td>org.apache.shiro.web.filter.authc.UserFilter</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>anon:æ‰€æœ‰ url éƒ½éƒ½å¯ä»¥åŒ¿åè®¿é—®</li>
  <li>authc: éœ€è¦è®¤è¯æ‰èƒ½è¿›è¡Œè®¿é—®</li>
  <li>user:é…ç½®è®°ä½æˆ‘æˆ–è®¤è¯é€šè¿‡å¯ä»¥è®¿é—®</li>
</ul>

<p><strong>ç™»å½•è®¤è¯å®ç°</strong></p>

<p>åœ¨è®¤è¯ã€æˆæƒå†…éƒ¨å®ç°æœºåˆ¶ä¸­éƒ½æœ‰æåˆ°ï¼Œæœ€ç»ˆå¤„ç†éƒ½å°†äº¤ç»™Realè¿›è¡Œå¤„ç†ã€‚å› ä¸ºåœ¨ Shiro ä¸­ï¼Œæœ€ç»ˆæ˜¯é€šè¿‡ Realm æ¥è·å–åº”ç”¨ç¨‹åºä¸­çš„ç”¨æˆ·ã€è§’è‰²åŠæƒé™ä¿¡æ¯çš„ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨ Realm ä¸­ä¼šç›´æ¥ä»æˆ‘ä»¬çš„æ•°æ®æºä¸­è·å– Shiro éœ€è¦çš„éªŒè¯ä¿¡æ¯ã€‚å¯ä»¥è¯´ï¼ŒRealm æ˜¯ä¸“ç”¨äºå®‰å…¨æ¡†æ¶çš„ DAO.
Shiro çš„è®¤è¯è¿‡ç¨‹æœ€ç»ˆä¼šäº¤ç”± Realm æ‰§è¡Œï¼Œè¿™æ—¶ä¼šè°ƒç”¨ Realm çš„<code class="highlighter-rouge">getAuthenticationInfo(token)</code>æ–¹æ³•ã€‚</p>

<p>è¯¥æ–¹æ³•ä¸»è¦æ‰§è¡Œä»¥ä¸‹æ“ä½œ:</p>

<ul>
  <li>1ã€æ£€æŸ¥æäº¤çš„è¿›è¡Œè®¤è¯çš„ä»¤ç‰Œä¿¡æ¯</li>
  <li>2ã€æ ¹æ®ä»¤ç‰Œä¿¡æ¯ä»æ•°æ®æº(é€šå¸¸ä¸ºæ•°æ®åº“)ä¸­è·å–ç”¨æˆ·ä¿¡æ¯</li>
  <li>3ã€å¯¹ç”¨æˆ·ä¿¡æ¯è¿›è¡ŒåŒ¹é…éªŒè¯ã€‚</li>
  <li>4ã€éªŒè¯é€šè¿‡å°†è¿”å›ä¸€ä¸ªå°è£…äº†ç”¨æˆ·ä¿¡æ¯çš„<code class="highlighter-rouge">AuthenticationInfo</code>å®ä¾‹ã€‚</li>
  <li>5ã€éªŒè¯å¤±è´¥åˆ™æŠ›å‡º<code class="highlighter-rouge">AuthenticationException</code>å¼‚å¸¸ä¿¡æ¯ã€‚</li>
</ul>

<p>è€Œåœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­è¦åšçš„å°±æ˜¯è‡ªå®šä¹‰ä¸€ä¸ª Realm ç±»ï¼Œç»§æ‰¿AuthorizingRealm æŠ½è±¡ç±»ï¼Œé‡è½½ doGetAuthenticationInfo()ï¼Œé‡å†™è·å–ç”¨æˆ·ä¿¡æ¯çš„æ–¹æ³•ã€‚</p>

<p>doGetAuthenticationInfo çš„é‡å†™</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="nc">AuthenticationInfo</span> <span class="nf">doGetAuthenticationInfo</span><span class="o">(</span><span class="nc">AuthenticationToken</span> <span class="n">token</span><span class="o">)</span>
        <span class="kd">throws</span> <span class="nc">AuthenticationException</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"MyShiroRealm.doGetAuthenticationInfo()"</span><span class="o">);</span>
    <span class="c1">//è·å–ç”¨æˆ·çš„è¾“å…¥çš„è´¦å·.</span>
    <span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span><span class="n">token</span><span class="o">.</span><span class="na">getPrincipal</span><span class="o">();</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">token</span><span class="o">.</span><span class="na">getCredentials</span><span class="o">());</span>
    <span class="c1">//é€šè¿‡usernameä»æ•°æ®åº“ä¸­æŸ¥æ‰¾ Userå¯¹è±¡ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œæ²¡æ‰¾åˆ°.</span>
    <span class="c1">//å®é™…é¡¹ç›®ä¸­ï¼Œè¿™é‡Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µåšç¼“å­˜ï¼Œå¦‚æœä¸åšï¼ŒShiroè‡ªå·±ä¹Ÿæ˜¯æœ‰æ—¶é—´é—´éš”æœºåˆ¶ï¼Œ2åˆ†é’Ÿå†…ä¸ä¼šé‡å¤æ‰§è¡Œè¯¥æ–¹æ³•</span>
    <span class="nc">UserInfo</span> <span class="n">userInfo</span> <span class="o">=</span> <span class="n">userInfoService</span><span class="o">.</span><span class="na">findByUsername</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"-----&gt;&gt;userInfo="</span><span class="o">+</span><span class="n">userInfo</span><span class="o">);</span>
    <span class="k">if</span><span class="o">(</span><span class="n">userInfo</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="nc">SimpleAuthenticationInfo</span> <span class="n">authenticationInfo</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleAuthenticationInfo</span><span class="o">(</span>
            <span class="n">userInfo</span><span class="o">,</span> <span class="c1">//ç”¨æˆ·å</span>
            <span class="n">userInfo</span><span class="o">.</span><span class="na">getPassword</span><span class="o">(),</span> <span class="c1">//å¯†ç </span>
            <span class="nc">ByteSource</span><span class="o">.</span><span class="na">Util</span><span class="o">.</span><span class="na">bytes</span><span class="o">(</span><span class="n">userInfo</span><span class="o">.</span><span class="na">getCredentialsSalt</span><span class="o">()),</span><span class="c1">//salt=username+salt</span>
            <span class="n">getName</span><span class="o">()</span>  <span class="c1">//realm name</span>
    <span class="o">);</span>
    <span class="k">return</span> <span class="n">authenticationInfo</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>é“¾æ¥æƒé™çš„å®ç°</strong></p>

<p>Shiro çš„æƒé™æˆæƒæ˜¯é€šè¿‡ç»§æ‰¿<code class="highlighter-rouge">AuthorizingRealm</code>æŠ½è±¡ç±»ï¼Œé‡è½½<code class="highlighter-rouge">doGetAuthorizationInfo();</code>å½“è®¿é—®åˆ°é¡µé¢çš„æ—¶å€™ï¼Œé“¾æ¥é…ç½®äº†ç›¸åº”çš„æƒé™æˆ–è€… Shiro æ ‡ç­¾æ‰ä¼šæ‰§è¡Œæ­¤æ–¹æ³•å¦åˆ™ä¸ä¼šæ‰§è¡Œï¼Œæ‰€ä»¥å¦‚æœåªæ˜¯ç®€å•çš„èº«ä»½è®¤è¯æ²¡æœ‰æƒé™çš„æ§åˆ¶çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å¯ä»¥ä¸è¿›è¡Œå®ç°ï¼Œç›´æ¥è¿”å› null å³å¯ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ä¸»è¦æ˜¯ä½¿ç”¨ç±»ï¼š<code class="highlighter-rouge">SimpleAuthorizationInfo</code>è¿›è¡Œè§’è‰²çš„æ·»åŠ å’Œæƒé™çš„æ·»åŠ ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="nc">AuthorizationInfo</span> <span class="nf">doGetAuthorizationInfo</span><span class="o">(</span><span class="nc">PrincipalCollection</span> <span class="n">principals</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"æƒé™é…ç½®--&gt;MyShiroRealm.doGetAuthorizationInfo()"</span><span class="o">);</span>
    <span class="nc">SimpleAuthorizationInfo</span> <span class="n">authorizationInfo</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleAuthorizationInfo</span><span class="o">();</span>
    <span class="nc">UserInfo</span> <span class="n">userInfo</span>  <span class="o">=</span> <span class="o">(</span><span class="nc">UserInfo</span><span class="o">)</span><span class="n">principals</span><span class="o">.</span><span class="na">getPrimaryPrincipal</span><span class="o">();</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">SysRole</span> <span class="nl">role:</span><span class="n">userInfo</span><span class="o">.</span><span class="na">getRoleList</span><span class="o">()){</span>
        <span class="n">authorizationInfo</span><span class="o">.</span><span class="na">addRole</span><span class="o">(</span><span class="n">role</span><span class="o">.</span><span class="na">getRole</span><span class="o">());</span>
        <span class="k">for</span><span class="o">(</span><span class="nc">SysPermission</span> <span class="nl">p:</span><span class="n">role</span><span class="o">.</span><span class="na">getPermissions</span><span class="o">()){</span>
            <span class="n">authorizationInfo</span><span class="o">.</span><span class="na">addStringPermission</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">getPermission</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">authorizationInfo</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>å½“ç„¶ä¹Ÿå¯ä»¥æ·»åŠ  set é›†åˆï¼šroles æ˜¯ä»æ•°æ®åº“æŸ¥è¯¢çš„å½“å‰ç”¨æˆ·çš„è§’è‰²ï¼ŒstringPermissions æ˜¯ä»æ•°æ®åº“æŸ¥è¯¢çš„å½“å‰ç”¨æˆ·å¯¹åº”çš„æƒé™</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">authorizationInfo</span><span class="o">.</span><span class="na">setRoles</span><span class="o">(</span><span class="n">roles</span><span class="o">);</span>
<span class="n">authorizationInfo</span><span class="o">.</span><span class="na">setStringPermissions</span><span class="o">(</span><span class="n">stringPermissions</span><span class="o">);</span>
</code></pre></div></div>

<p>å°±æ˜¯è¯´å¦‚æœåœ¨shiroé…ç½®æ–‡ä»¶ä¸­æ·»åŠ äº†<code class="highlighter-rouge">filterChainDefinitionMap.put(â€œ/addâ€, â€œperms[æƒé™æ·»åŠ ]â€);</code>å°±è¯´æ˜è®¿é—®/addè¿™ä¸ªé“¾æ¥å¿…é¡»è¦æœ‰â€œæƒé™æ·»åŠ â€è¿™ä¸ªæƒé™æ‰å¯ä»¥è®¿é—®ï¼Œå¦‚æœåœ¨shiroé…ç½®æ–‡ä»¶ä¸­æ·»åŠ äº†<code class="highlighter-rouge">filterChainDefinitionMap.put(â€œ/addâ€, â€œroles[100002]ï¼Œperms[æƒé™æ·»åŠ ]â€);</code>å°±è¯´æ˜è®¿é—®<code class="highlighter-rouge">/add</code>è¿™ä¸ªé“¾æ¥å¿…é¡»è¦æœ‰â€œæƒé™æ·»åŠ â€è¿™ä¸ªæƒé™å’Œå…·æœ‰â€œ100002â€è¿™ä¸ªè§’è‰²æ‰å¯ä»¥è®¿é—®ã€‚</p>

<p><strong>ç™»å½•å®ç°</strong></p>

<p>ç™»å½•è¿‡ç¨‹å…¶å®åªæ˜¯å¤„ç†å¼‚å¸¸çš„ç›¸å…³ä¿¡æ¯ï¼Œå…·ä½“çš„ç™»å½•éªŒè¯äº¤ç»™ Shiro æ¥å¤„ç†</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/login"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">login</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"HomeController.login()"</span><span class="o">);</span>
    <span class="c1">// ç™»å½•å¤±è´¥ä»requestä¸­è·å–shiroå¤„ç†çš„å¼‚å¸¸ä¿¡æ¯ã€‚</span>
    <span class="c1">// shiroLoginFailure:å°±æ˜¯shiroå¼‚å¸¸ç±»çš„å…¨ç±»å.</span>
    <span class="nc">String</span> <span class="n">exception</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">request</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">"shiroLoginFailure"</span><span class="o">);</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"exception="</span> <span class="o">+</span> <span class="n">exception</span><span class="o">);</span>
    <span class="nc">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">exception</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="nc">UnknownAccountException</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">exception</span><span class="o">))</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"UnknownAccountException -- &gt; è´¦å·ä¸å­˜åœ¨ï¼š"</span><span class="o">);</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">"UnknownAccountException -- &gt; è´¦å·ä¸å­˜åœ¨ï¼š"</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="nc">IncorrectCredentialsException</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">exception</span><span class="o">))</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"IncorrectCredentialsException -- &gt; å¯†ç ä¸æ­£ç¡®ï¼š"</span><span class="o">);</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">"IncorrectCredentialsException -- &gt; å¯†ç ä¸æ­£ç¡®ï¼š"</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="s">"kaptchaValidateFailed"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">exception</span><span class="o">))</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"kaptchaValidateFailed -- &gt; éªŒè¯ç é”™è¯¯"</span><span class="o">);</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">"kaptchaValidateFailed -- &gt; éªŒè¯ç é”™è¯¯"</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">"else &gt;&gt; "</span><span class="o">+</span><span class="n">exception</span><span class="o">;</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"else -- &gt;"</span> <span class="o">+</span> <span class="n">exception</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"msg"</span><span class="o">,</span> <span class="n">msg</span><span class="o">);</span>
    <span class="c1">// æ­¤æ–¹æ³•ä¸å¤„ç†ç™»å½•æˆåŠŸ,ç”±shiroè¿›è¡Œå¤„ç†</span>
    <span class="k">return</span> <span class="s">"/login"</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>å…¶å®ƒ Dao å±‚å’Œ Service çš„ä»£ç å°±ä¸è´´å‡ºæ¥äº†å¤§å®¶ç›´æ¥çœ‹ä»£ç ã€‚</p>

<h3 id="æµ‹è¯•">æµ‹è¯•</h3>

<p>1ã€ç¼–å†™å¥½åå°±å¯ä»¥å¯åŠ¨ç¨‹åºï¼Œè®¿é—®<code class="highlighter-rouge">http://localhost:8080/userInfo/userList</code>é¡µé¢ï¼Œç”±äºæ²¡æœ‰ç™»å½•å°±ä¼šè·³è½¬åˆ°<code class="highlighter-rouge">http://localhost:8080/login</code>é¡µé¢ã€‚ç™»å½•ä¹‹åå°±ä¼šè·³è½¬åˆ° index é¡µé¢ï¼Œç™»å½•åï¼Œç›´æ¥åœ¨æµè§ˆå™¨ä¸­è¾“å…¥<code class="highlighter-rouge">http://localhost:8080/userInfo/userList</code>è®¿é—®å°±ä¼šçœ‹åˆ°ç”¨æˆ·ä¿¡æ¯ã€‚ä¸Šé¢è¿™äº›æ“ä½œæ—¶å€™è§¦å‘<code class="highlighter-rouge">MyShiroRealm.doGetAuthenticationInfo()</code>è¿™ä¸ªæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ç™»å½•è®¤è¯çš„æ–¹æ³•ã€‚</p>

<p>2ã€ç™»å½•adminè´¦æˆ·ï¼Œè®¿é—®ï¼š<code class="highlighter-rouge">http://127.0.0.1:8080/userInfo/userAdd</code>æ˜¾ç¤º<code class="highlighter-rouge">ç”¨æˆ·æ·»åŠ ç•Œé¢</code>ï¼Œè®¿é—®<code class="highlighter-rouge">http://127.0.0.1:8080/userInfo/userDel</code>æ˜¾ç¤º<code class="highlighter-rouge">403æ²¡æœ‰æƒé™</code>ã€‚ä¸Šé¢è¿™äº›æ“ä½œæ—¶å€™è§¦å‘<code class="highlighter-rouge">MyShiroRealm.doGetAuthorizationInfo()</code>è¿™ä¸ªæ–¹é¢ï¼Œä¹Ÿå°±æ˜¯æƒé™æ ¡éªŒçš„æ–¹æ³•ã€‚</p>

<p>3ã€ä¿®æ”¹ adminä¸ åŒçš„æƒé™è¿›è¡Œæµ‹è¯•</p>

<p>Shiro å¾ˆå¼ºå¤§ï¼Œè¿™ä»…ä»…æ˜¯å®Œæˆäº†ç™»å½•è®¤è¯å’Œæƒé™ç®¡ç†è¿™ä¸¤ä¸ªåŠŸèƒ½ï¼Œæ›´å¤šå†…å®¹ä»¥åæœ‰æ—¶é—´å†åšæ¢è®¨ã€‚</p>

<blockquote>
  <p>æ–‡ç« å†…å®¹å·²ç»å‡çº§åˆ° Spring Boot 2.x</p>
</blockquote>

<p><strong><a href="https://github.com/ityouknow/spring-boot-examples/tree/master/spring-boot-shiro">ç¤ºä¾‹ä»£ç -github</a></strong></p>

<p><strong><a href="https://gitee.com/ityouknow/spring-boot-examples/tree/master/spring-boot-shiro">ç¤ºä¾‹ä»£ç -ç äº‘</a></strong></p>

<p>å‚è€ƒï¼š</p>

<p><a href="https://waylau.gitbooks.io/apache-shiro-1-2-x-reference/content/">Apache Shiroä¸­æ–‡æ‰‹å†Œ</a> <br />
<a href="http://412887952-qq-com.iteye.com/blog/2299777">Spring Boot Shiroæƒé™ç®¡ç†ã€ä»é›¶å¼€å§‹å­¦Spring Bootã€‘</a><br />
<a href="http://z77z.oschina.io/2017/02/13/SpringBoot+shiro%E6%95%B4%E5%90%88%E5%AD%A6%E4%B9%A0%E4%B9%8B%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81%E5%92%8C%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6/">SpringBoot+shiroæ•´åˆå­¦ä¹ ä¹‹ç™»å½•è®¤è¯å’Œæƒé™æ§åˆ¶</a></p>
:ET